import{a6 as e,a7 as a,r as t,$ as s,Z as r,d as n,c as i,ag as c,ah as l,a2 as o,ai as u,aj as p,B as _,ak as d,i as g,n as f,al as y,am as m,ac as h,an as w,ad as k,ao as v,ap as b,a1 as A,aq as I,ar as x,a as q,b as j}from"./main-TC3Bu45J.js";import{u as P,a as S,b as E}from"./index-jviZh_iP.js";import{N as C,a as F,w as K,T as z,H as T,O as U}from"./business-CSi1hkxo.js";import{g as M,a as D,u as L,d as O,t as R}from"./access-CVoV-9UZ.js";import{A as B}from"./data-CXwlriQE.js";import{S as N}from"./index-OvFH652L.js";import{T as V}from"./index-DF0RwvD-.js";import{n as H}from"./utils-CRt-4gJj.js";import{E as J,S as W}from"./index-DXyQC-X-.js";import{B as $}from"./index-D0djR_cB.js";import{u as G}from"./index-Cdsjg_sg.js";const Z=r(),Q=e("auth-api-manage-store",(()=>{const{handleError:e}=P(),a=t({name:"",type:"btpanel",config:{url:"",api_key:"",ignore_ssl:"0"}}),r={dns:s("t_3_1745735765112"),host:s("t_0_1746754500246")},n=()=>{a.value={name:"",type:"btpanel",config:{url:"",api_key:"",ignore_ssl:"0"}}};return{apiFormProps:a,accessTypeMap:r,fetchAccessList:async a=>{try{const e=await M(a).fetch();return{list:e.data||[],total:e.count}}catch(t){return e(t),{list:[],total:0}}},addNewAccess:async a=>{try{const{fetch:e,message:t}=D(a);t.value=!0,await e(),n()}catch(t){throw e(t)&&Z.error(s("t_8_1745289354902")),t}},updateExistingAccess:async a=>{try{const{fetch:e,message:t}=L(a);t.value=!0,await e(),n()}catch(t){throw e(t)&&Z.error(s("t_40_1745227838872")),t}},deleteExistingAccess:async a=>{try{const{fetch:e,message:t}=O({id:a});t.value=!0,await e(),n()}catch(t){throw e(t)&&Z.error(s("t_40_1745227838872")),t}},resetApiForm:n}})),X=n({name:"ApiManageForm",props:{data:{type:Object,default:()=>{}}},setup(e){const{ApiManageForm:a}=oe(e);return()=>i("div",{class:"p-4"},[i(a,{labelPlacement:"top",requireMarkPlacement:"right-hanging"},null)])}});function Y(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!g(e)}const{accessTypeMap:ee,apiFormProps:ae,fetchAccessList:te,deleteExistingAccess:se,addNewAccess:re,updateExistingAccess:ne,resetApiForm:ie}=(()=>{const e=Q();return{...e,...a(e)}})(),{handleError:ce}=P(),le=()=>{const{component:e,loading:a,param:t,total:r,fetch:n}=c({config:[{title:s("t_2_1745289353944"),key:"name",width:200,ellipsis:{tooltip:!0}},{title:s("t_1_1746754499371"),key:"type",width:120,render:e=>i(V,{icon:e.type,type:"success"},null)},{title:s("t_2_1746754500270"),key:"type",width:180,render:e=>i(p,null,{default:()=>{var a;return[null==(a=e.access_type)?void 0:a.map((e=>i(u,{key:e,type:"dns"===e?"success":"info",size:"small"},{default:()=>[ee[e]]})))]}})},{title:s("t_7_1745215914189"),key:"create_time",width:180},{title:s("t_0_1745295228865"),key:"update_time",width:180},{title:s("t_8_1745215914610"),key:"actions",width:240,align:"right",fixed:"right",render:e=>{let a,t,r;return i(p,{justify:"end"},{default:()=>[i(_,{size:"tiny",strong:!0,secondary:!0,type:"primary",onClick:()=>(async e=>{try{const{fetch:a,message:t}=R({id:e.id,type:e.type});t.value=!0,a()}catch(a){ce(a)}})(e)},Y(a=s("t_16_1746676855270"))?a:{default:()=>[a]}),i(_,{size:"tiny",strong:!0,secondary:!0,type:"primary",onClick:()=>f(e)},Y(t=s("t_11_1745215915429"))?t:{default:()=>[t]}),i(_,{size:"tiny",strong:!0,secondary:!0,type:"error",onClick:()=>y(e.id)},Y(r=s("t_12_1745215914312"))?r:{default:()=>[r]})]})}}],request:te,defaultValue:{p:1,limit:10,search:""},watchValue:["p","limit"]}),{component:g}=l({param:t,total:r,alias:{page:"p",pageSize:"limit"}}),f=e=>{d({title:s("t_4_1745289354902"),area:500,component:X,componentProps:{data:e},footer:!0,onUpdateShow:e=>{e||n(),ie()}})},y=e=>{S({title:s("t_5_1745289355718"),content:s("t_6_1745289358340"),confirmText:s("t_5_1744870862719"),cancelText:s("t_4_1744870861589"),onPositiveClick:async()=>{await se(e),await n()}})};return o(n),{loading:a,fetch:n,ApiTable:e,ApiTablePage:g,param:t,total:r,openAddForm:()=>{d({title:s("t_0_1745289355714"),area:500,component:X,footer:!0,onUpdateShow:e=>{e||n(),ie()}})}}},oe=e=>{var a;const{confirm:r}=x(),{open:n,close:c}=E({text:s("t_0_1746667592819")}),{useFormInput:l,useFormRadioButton:o,useFormSwitch:p,useFormTextarea:_,useFormCustom:d}=y(),g=(null==(a=e.data)?void 0:a.id)?t({...e.data,config:JSON.parse(e.data.config)}):ae,q={name:{required:!0,message:s("t_27_1745289355721"),trigger:"input"},type:{required:!0,message:s("t_28_1745289356040"),trigger:"change"},config:{host:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!U(a))return t(new Error(s("t_0_1745317313835")));t()}},port:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!T(a.toString()))return t(new Error(s("t_1_1745317313096")));t()}},user:{required:!0,trigger:"input",message:s("t_3_1744164839524")},username:{required:!0,message:s("t_0_1747365600180"),trigger:"input"},password:{trigger:"input",validator:(e,a,t)=>{if(!a){const e={westcn:s("t_1_1747365603108"),ssh:s("t_0_1747711335067")};return t(new Error(e[g.value.type]))}t()}},key:{required:!0,message:s("t_31_1745289355715"),trigger:"input"},url:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!z(a)){const e={btpanel:s("t_2_1745317314362"),btwaf:s("t_0_1747271295174"),safeline:s("t_0_1747300383756")};return t(new Error(e[g.value.type]))}t()}},api_key:{trigger:"input",validator:(e,a,t)=>{if(!a.length){const e={cloudflare:s("t_0_1747042966820"),btpanel:s("t_1_1747042969705"),btwaf:s("t_1_1747300384579"),godaddy:s("t_0_1747984137443"),ns1:"请输入API Key",namecheap:"请输入API Key"};return t(new Error(e[g.value.type]))}t()}},api_secret:{required:!0,message:s("t_1_1747984133312"),trigger:"input"},access_secret:{required:!0,message:s("t_2_1747984134626"),trigger:"input"},api_token:{required:!0,message:s("t_0_1747617113090"),trigger:"input"},access_key_id:{required:!0,message:s("t_4_1745317314054"),trigger:"input"},access_key_secret:{required:!0,message:s("t_5_1745317315285"),trigger:"input"},secret_access_key:{required:!0,message:"请输入Secret Access Key",trigger:"input"},api_user:{required:!0,message:"请输入API User",trigger:"input"},auth_id:{required:!0,message:"请输入Auth ID",trigger:"input"},auth_password:{required:!0,message:"请输入Auth Password",trigger:"input"},tenant_id:{required:!0,message:"请输入Tenant ID",trigger:"input"},client_id:{required:!0,message:"请输入Client ID",trigger:"input"},client_secret:{required:!0,message:"请输入Client Secret",trigger:"input"},secret_id:{required:!0,message:s("t_6_1745317313383"),trigger:"input"},access_key:{trigger:"input",validator:(e,a,t)=>{if(!a){const e={huawei:s("t_2_1747271295877"),baidu:s("t_3_1747271294475"),volcengine:s("t_3_1747365600828"),qiniu:s("t_3_1747984134586")};return t(new Error(e[g.value.type]))}t()}},secret_key:{trigger:"input",validator:(e,a,t)=>{if(!a.length){const e={tencentcloud:s("t_2_1747042967277"),huawei:s("t_3_1747042967608"),baidu:s("t_4_1747271294621"),volcengine:s("t_4_1747365600137")};return t(new Error(e[g.value.type]))}t()}},email:{trigger:"input",validator:(e,a,t)=>{if(!K(a))return t(new Error(s("t_5_1747042965911")));t()}}}},j=Object.entries(B).filter((([e,a])=>!("boolean"==typeof a.notApi&&!a.notApi))).map((([e,a])=>({label:a.name,value:e,access:a.type||[]}))),P=new Map([["btwaf","宝塔WAF-URL"],["btpanel","宝塔面板-URL"],["1panel","1Panel-URL"],["safeline","雷池WAF-URL"]]),S=f((()=>{var a;const t=[l(s("t_2_1745289353944"),"name"),d((()=>i(h,{label:s("t_41_1745289354902"),path:"type"},{default:()=>{var a;return[i(m,{class:"w-full",options:j,renderLabel:D,renderTag:M,disabled:!!(null==(a=e.data)?void 0:a.id),filterable:!0,placeholder:s("t_0_1745833934390"),value:g.value.type,"onUpdate:value":e=>g.value.type=e},{empty:()=>i("span",{class:"text-[1.4rem]"},[s("t_0_1745833934390")])})]}})))];switch(g.value.type){case"ssh":t.push(d((()=>i(b,{cols:24,xGap:4},{default:()=>[i(w,{label:s("t_1_1747711335336"),span:16,path:"config.host"},{default:()=>[i(k,{value:g.value.config.host,"onUpdate:value":e=>g.value.config.host=e,placeholder:s("t_2_1747711337958"),"allow-input":H},null)]}),i(w,{label:s("t_2_1745833931404"),span:8,path:"config.port"},{default:()=>[i(v,{value:g.value.config.port,"onUpdate:value":e=>g.value.config.port=e,showButton:!1},null)]})]}))),l(s("t_44_1745289354583"),"config.user"),o(s("t_45_1745289355714"),"config.mode",[{label:s("t_48_1745289355714"),value:"password"},{label:s("t_1_1746667588689"),value:"key"}]),"password"===(null==(a=g.value.config)?void 0:a.mode)?l(s("t_48_1745289355714"),"config.password",{allowInput:H}):_(s("t_1_1746667588689"),"config.key",{rows:3,placeholder:s("t_0_1747709067998")}));break;case"1panel":case"btpanel":case"btwaf":case"safeline":t.push(l(P.get(g.value.type)||"","config.url",{allowInput:H}),l("safeline"===g.value.type?s("t_1_1747617105179"):s("t_55_1745289355715"),"safeline"===g.value.type?"config.api_token":"config.api_key",{allowInput:H}),p(s("t_3_1746667592270"),"config.ignore_ssl",{checkedValue:"1",uncheckedValue:"0"},{showRequireMark:!1}));break;case"aliyun":t.push(l("AccessKeyId","config.access_key_id",{allowInput:H}),l("AccessKeySecret","config.access_key_secret",{allowInput:H}));break;case"tencentcloud":t.push(l("SecretId","config.secret_id",{allowInput:H}),l("SecretKey","config.secret_key",{allowInput:H}));break;case"huaweicloud":case"baidu":case"volcengine":t.push(l("AccessKey","config.access_key",{allowInput:H}),l("SecretKey","config.secret_key",{allowInput:H}));break;case"cloudflare":t.push(l("邮箱","config.email",{allowInput:H}),l("APIKey","config.api_key",{allowInput:H}));break;case"westcn":t.push(l("Username","config.username",{allowInput:H}),l("Password","config.password",{allowInput:H}));break;case"godaddy":t.push(l("API Key","config.api_key",{allowInput:H}),l("API Secret","config.api_secret",{allowInput:H}));break;case"qiniu":t.push(l("AccessKey","config.access_key",{allowInput:H}),l("AccessSecret","config.access_secret",{allowInput:H}));break;case"namecheap":t.push(l("API User","config.api_user",{allowInput:H}),l("API Key","config.api_key",{allowInput:H}));break;case"ns1":t.push(l("API Key","config.api_key",{allowInput:H}));break;case"cloudns":t.push(l("Auth ID","config.auth_id",{allowInput:H}),l("Auth Password","config.auth_password",{allowInput:H}));break;case"aws":t.push(l("Access Key ID","config.access_key_id",{allowInput:H}),l("Secret Access Key","config.secret_access_key",{allowInput:H}));break;case"azure":t.push(l("Tenant ID","config.tenant_id",{allowInput:H}),l("Client ID","config.client_id",{allowInput:H}),l("Client Secret","config.client_secret",{allowInput:H}),l("Environment","config.environment",{allowInput:H,placeholder:"public"}))}return t}));A((()=>g.value.type),(e=>{switch(e){case"ssh":g.value.config={host:"",port:22,user:"root",mode:"password",password:""};break;case"1panel":case"btpanel":case"btwaf":g.value.config={url:"",api_key:"",ignore_ssl:"0"};break;case"aliyun":g.value.config={access_key_id:"",access_key_secret:""};break;case"baidu":case"huaweicloud":g.value.config={access_key:"",secret_key:""};break;case"cloudflare":g.value.config={email:"",api_key:""};break;case"tencentcloud":g.value.config={secret_id:"",secret_key:""};break;case"godaddy":g.value.config={api_key:"",api_secret:""};break;case"qiniu":g.value.config={access_key:"",access_secret:""};break;case"namecheap":g.value.config={api_user:"",api_key:""};break;case"ns1":g.value.config={api_key:""};break;case"cloudns":g.value.config={auth_id:"",auth_password:""};break;case"aws":g.value.config={access_key_id:"",secret_access_key:""};break;case"azure":g.value.config={tenant_id:"",client_id:"",client_secret:"",environment:""}}}));const M=({option:e})=>i(C,{class:"w-full"},{default:()=>[e.label?D(e):i("span",{class:"text-[1.4rem] text-gray-400"},[s("t_0_1745833934390")])]}),D=e=>i(C,{justify:"space-between",class:"w-[38rem]"},{default:()=>[i(C,{align:"center",size:"small"},{default:()=>[i(N,{icon:`resources-${e.value}`,size:"1.6rem"},null),i(F,null,{default:()=>[e.label]})]}),i(C,{class:"pr-[1rem]"},{default:()=>[e.access&&e.access.map((e=>i(u,{type:"dns"===e?"success":"info",size:"small",key:e},{default:()=>[ee[e]]})))]})]}),{component:L,fetch:O}=I({config:S,defaultValue:g,request:async(e,a)=>{try{const a={...e,config:JSON.stringify(e.config)};if("id"in e){const{id:e,name:t,config:s}=a;await ne({id:e.toString(),name:t,config:s})}else await re(a)}catch(t){throw ce(new Error(s("t_4_1746667590873")))}},rules:q});return r((async e=>{try{n(),await O(),ie(),e()}catch(a){return ce(a)}finally{c()}})),{ApiManageForm:L}};const ue=n({name:"AuthApiManage",setup(){const{ApiTable:e,ApiTablePage:a,param:t,fetch:r,total:n,openAddForm:c}=le(),l=q(["contentPadding","borderColor","headerHeight","iconColorHover"]);return()=>i("div",{class:"h-full flex flex-col",style:l.value},[i("div",{class:"mx-auto max-w-[1600px] w-full p-6"},[i($,null,{headerLeft:()=>{let e;return i(_,{type:"primary",size:"large",class:"px-5",onClick:c},"function"==typeof(a=e=s("t_0_1745289355714"))||"[object Object]"===Object.prototype.toString.call(a)&&!g(a)?e:{default:()=>[e]});var a},headerRight:()=>i(k,{value:t.value.search,"onUpdate:value":e=>t.value.search=e,onKeydown:e=>{"Enter"===e.key&&r()},onClear:()=>G((()=>r()),100),placeholder:s("t_0_1745289808449"),clearable:!0,size:"large",class:"min-w-[300px]"},{suffix:()=>i("div",{class:"flex items-center cursor-pointer",onClick:r},[i(W,{class:"text-[var(--text-color-3)] w-[1.6rem] font-bold"},null)])}),content:()=>i("div",{class:"rounded-lg"},[i(e,{size:"medium"},{empty:()=>i(J,{addButtonText:s("t_0_1745289355714"),onAddClick:c},null)})]),footerRight:()=>i("div",{class:"mt-4 flex justify-end"},[i(a,null,{prefix:()=>i("span",null,[s("t_15_1745227839354"),j(" "),n.value,j(" "),s("t_16_1745227838930")])})])})])])}});export{ue as default};
