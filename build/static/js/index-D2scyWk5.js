import{e,s as a,r as t,$ as s,f as r,d as n,c as i,g as c,h as o,o as l,N as u,j as p,B as _,k as d,i as g,l as f,m as y,n as m,p as h,q as w,t as k,v,w as b,x as I,y as A,z as x,a as q,b as j}from"./main-D37kYvfP.js";import{u as P,a as S,b as E}from"./index-DuE5FJUK.js";import{N as F,a as K,w as T,T as C,H as z,O as U,b as M}from"./business-3db_PQBB.js";import{g as L,a as O,u as R,d as D,t as N}from"./access-D5PuzSlL.js";import{A as B}from"./data-C6c8domP.js";import{S as V}from"./index-CfX9d1jr.js";import{T as H}from"./index-C7gpdCu4.js";import{n as J}from"./utils-CRt-4gJj.js";import{E as W,S as $}from"./index-atRq13wP.js";import{B as G}from"./index-CkZPJuYU.js";import{u as Q}from"./index-D8XFZQMn.js";const X=r(),Y=e("auth-api-manage-store",(()=>{const{handleError:e}=P(),a=t({name:"",type:"btpanel",config:{url:"",api_key:"",ignore_ssl:"0"}}),r={dns:s("t_3_1745735765112"),host:s("t_0_1746754500246")},n=()=>{a.value={name:"",type:"btpanel",config:{url:"",api_key:"",ignore_ssl:"0"}}};return{apiFormProps:a,accessTypeMap:r,fetchAccessList:async a=>{try{const e=await L(a).fetch();return{list:e.data||[],total:e.count}}catch(t){return e(t),{list:[],total:0}}},addNewAccess:async a=>{try{const{fetch:e,message:t}=O(a);t.value=!0,await e(),n()}catch(t){throw e(t)&&X.error(s("t_8_1745289354902")),t}},updateExistingAccess:async a=>{try{const{fetch:e,message:t}=R(a);t.value=!0,await e(),n()}catch(t){throw e(t)&&X.error(s("t_40_1745227838872")),t}},deleteExistingAccess:async a=>{try{const{fetch:e,message:t}=D({id:a});t.value=!0,await e(),n()}catch(t){throw e(t)&&X.error(s("t_40_1745227838872")),t}},resetApiForm:n}})),Z=n({name:"ApiManageForm",props:{data:{type:Object,default:()=>{}}},setup(e){const{ApiManageForm:a}=ue(e);return()=>i("div",{class:"p-4"},[i(a,{labelPlacement:"top",requireMarkPlacement:"right-hanging"},null)])}});function ee(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!g(e)}const{accessTypeMap:ae,apiFormProps:te,fetchAccessList:se,deleteExistingAccess:re,addNewAccess:ne,updateExistingAccess:ie,resetApiForm:ce}=(()=>{const e=Y();return{...e,...a(e)}})(),{handleError:oe}=P(),le=()=>{const{component:e,loading:a,param:t,total:r,fetch:n}=c({config:[{title:s("t_2_1745289353944"),key:"name",width:200,ellipsis:{tooltip:!0}},{title:s("t_1_1746754499371"),key:"type",width:120,render:e=>i(H,{icon:e.type,type:"success"},null)},{title:s("t_2_1746754500270"),key:"type",width:180,render:e=>i(p,null,{default:()=>{var a;return[null==(a=e.access_type)?void 0:a.map((e=>i(u,{key:e,type:"dns"===e?"success":"info",size:"small"},{default:()=>[ae[e]]})))]}})},{title:s("t_7_1745215914189"),key:"create_time",width:180},{title:s("t_0_1745295228865"),key:"update_time",width:180},{title:s("t_8_1745215914610"),key:"actions",width:240,align:"right",fixed:"right",render:e=>{let a,t,r;return i(p,{justify:"end"},{default:()=>[i(_,{size:"tiny",strong:!0,secondary:!0,type:"primary",onClick:()=>(async e=>{try{const{fetch:a,message:t}=N({id:e.id,type:e.type});t.value=!0,a()}catch(a){oe(a)}})(e)},ee(a=s("t_16_1746676855270"))?a:{default:()=>[a]}),i(_,{size:"tiny",strong:!0,secondary:!0,type:"primary",onClick:()=>f(e)},ee(t=s("t_11_1745215915429"))?t:{default:()=>[t]}),i(_,{size:"tiny",strong:!0,secondary:!0,type:"error",onClick:()=>y(e.id)},ee(r=s("t_12_1745215914312"))?r:{default:()=>[r]})]})}}],request:se,defaultValue:{p:1,limit:10,search:""},watchValue:["p","limit"]}),{component:g}=o({param:t,total:r,alias:{page:"p",pageSize:"limit"}}),f=e=>{d({title:s("t_4_1745289354902"),area:500,component:Z,componentProps:{data:e},footer:!0,onUpdateShow:e=>{e||n(),ce()}})},y=e=>{S({title:s("t_5_1745289355718"),content:s("t_6_1745289358340"),confirmText:s("t_5_1744870862719"),cancelText:s("t_4_1744870861589"),onPositiveClick:async()=>{await re(e),await n()}})};return l(n),{loading:a,fetch:n,ApiTable:e,ApiTablePage:g,param:t,total:r,openAddForm:()=>{d({title:s("t_0_1745289355714"),area:500,component:Z,footer:!0,onUpdateShow:e=>{e||n(),ce()}})}}},ue=e=>{var a;const{confirm:r}=x(),{open:n,close:c}=E({text:s("t_0_1746667592819")}),{useFormInput:o,useFormRadioButton:l,useFormSwitch:p,useFormTextarea:_,useFormCustom:d}=y(),g=(null==(a=e.data)?void 0:a.id)?t({...e.data,config:JSON.parse(e.data.config)}):te,q={name:{required:!0,message:s("t_27_1745289355721"),trigger:"input"},type:{required:!0,message:s("t_28_1745289356040"),trigger:"change"},config:{host:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!U(a)&&!M(a))return t(new Error(s("t_0_1749119980577")));t()}},port:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!z(a.toString()))return t(new Error(s("t_1_1745317313096")));t()}},user:{required:!0,trigger:"input",message:s("t_3_1744164839524")},username:{required:!0,message:s("t_0_1747365600180"),trigger:"input"},password:{trigger:"input",validator:(e,a,t)=>{if(!a){const e={westcn:s("t_1_1747365603108"),ssh:s("t_0_1747711335067")};return t(new Error(e[g.value.type]))}t()}},key:{required:!0,message:s("t_31_1745289355715"),trigger:"input"},url:{required:!0,trigger:"input",validator:(e,a,t)=>{if(!C(a)){const e={btpanel:s("t_2_1745317314362"),btwaf:s("t_0_1747271295174"),safeline:s("t_0_1747300383756")};return t(new Error(e[g.value.type]))}t()}},api_key:{trigger:"input",validator:(e,a,t)=>{if(!a.length){const e={cloudflare:s("t_0_1747042966820"),btpanel:s("t_1_1747042969705"),btwaf:s("t_1_1747300384579"),godaddy:s("t_0_1747984137443"),ns1:"请输入API Key",namecheap:"请输入API Key"};return t(new Error(e[g.value.type]))}t()}},api_secret:{required:!0,message:s("t_1_1747984133312"),trigger:"input"},access_secret:{required:!0,message:s("t_2_1747984134626"),trigger:"input"},api_token:{required:!0,message:s("t_0_1747617113090"),trigger:"input"},access_key_id:{required:!0,message:s("t_4_1745317314054"),trigger:"input"},access_key_secret:{required:!0,message:s("t_5_1745317315285"),trigger:"input"},secret_access_key:{required:!0,message:"请输入Secret Access Key",trigger:"input"},api_user:{required:!0,message:"请输入API User",trigger:"input"},auth_id:{required:!0,message:"请输入Auth ID",trigger:"input"},auth_password:{required:!0,message:"请输入Auth Password",trigger:"input"},tenant_id:{required:!0,message:"请输入Tenant ID",trigger:"input"},client_id:{required:!0,message:"请输入Client ID",trigger:"input"},client_secret:{required:!0,message:"请输入Client Secret",trigger:"input"},secret_id:{required:!0,message:s("t_6_1745317313383"),trigger:"input"},access_key:{trigger:"input",validator:(e,a,t)=>{if(!a){const e={huawei:s("t_2_1747271295877"),baidu:s("t_3_1747271294475"),volcengine:s("t_3_1747365600828"),qiniu:s("t_3_1747984134586")};return t(new Error(e[g.value.type]))}t()}},secret_key:{trigger:"input",validator:(e,a,t)=>{if(!a.length){const e={tencentcloud:s("t_2_1747042967277"),huawei:s("t_3_1747042967608"),baidu:s("t_4_1747271294621"),volcengine:s("t_4_1747365600137")};return t(new Error(e[g.value.type]))}t()}},email:{trigger:"input",validator:(e,a,t)=>{if(!T(a))return t(new Error(s("t_5_1747042965911")));t()}}}},j=Object.entries(B).filter((([e,a])=>!("boolean"==typeof a.notApi&&!a.notApi))).map((([e,a])=>({label:a.name,value:e,access:a.type||[]}))),P=new Map([["btwaf","宝塔WAF-URL"],["btpanel","宝塔面板-URL"],["1panel","1Panel-URL"],["safeline","雷池WAF-URL"]]),S=f((()=>{var a;const t=[o(s("t_2_1745289353944"),"name"),d((()=>i(h,{label:s("t_41_1745289354902"),path:"type"},{default:()=>{var a;return[i(m,{class:"w-full",options:j,renderLabel:O,renderTag:L,disabled:!!(null==(a=e.data)?void 0:a.id),filterable:!0,placeholder:s("t_0_1745833934390"),value:g.value.type,"onUpdate:value":e=>g.value.type=e},{empty:()=>i("span",{class:"text-[1.4rem]"},[s("t_0_1745833934390")])})]}})))];switch(g.value.type){case"ssh":t.push(d((()=>i(b,{cols:24,xGap:4},{default:()=>[i(w,{label:s("t_1_1747711335336"),span:16,path:"config.host"},{default:()=>[i(k,{value:g.value.config.host,"onUpdate:value":e=>g.value.config.host=e,placeholder:s("t_2_1747711337958"),"allow-input":J},null)]}),i(w,{label:s("t_2_1745833931404"),span:8,path:"config.port"},{default:()=>[i(v,{value:g.value.config.port,"onUpdate:value":e=>g.value.config.port=e,showButton:!1},null)]})]}))),o(s("t_44_1745289354583"),"config.user"),l(s("t_45_1745289355714"),"config.mode",[{label:s("t_48_1745289355714"),value:"password"},{label:s("t_1_1746667588689"),value:"key"}]),"password"===(null==(a=g.value.config)?void 0:a.mode)?o(s("t_48_1745289355714"),"config.password",{allowInput:J}):_(s("t_1_1746667588689"),"config.key",{rows:3,placeholder:s("t_0_1747709067998")}));break;case"1panel":case"btpanel":case"btwaf":case"safeline":t.push(o(P.get(g.value.type)||"","config.url",{allowInput:J}),o("safeline"===g.value.type?s("t_1_1747617105179"):s("t_55_1745289355715"),"safeline"===g.value.type?"config.api_token":"config.api_key",{allowInput:J}),p(s("t_3_1746667592270"),"config.ignore_ssl",{checkedValue:"1",uncheckedValue:"0"},{showRequireMark:!1}));break;case"aliyun":t.push(o("AccessKeyId","config.access_key_id",{allowInput:J}),o("AccessKeySecret","config.access_key_secret",{allowInput:J}));break;case"tencentcloud":t.push(o("SecretId","config.secret_id",{allowInput:J}),o("SecretKey","config.secret_key",{allowInput:J}));break;case"huaweicloud":case"baidu":case"volcengine":t.push(o("AccessKey","config.access_key",{allowInput:J}),o("SecretKey","config.secret_key",{allowInput:J}));break;case"cloudflare":t.push(o("邮箱","config.email",{allowInput:J}),o("APIKey","config.api_key",{allowInput:J}));break;case"westcn":t.push(o("Username","config.username",{allowInput:J}),o("Password","config.password",{allowInput:J}));break;case"godaddy":t.push(o("API Key","config.api_key",{allowInput:J}),o("API Secret","config.api_secret",{allowInput:J}));break;case"qiniu":t.push(o("AccessKey","config.access_key",{allowInput:J}),o("AccessSecret","config.access_secret",{allowInput:J}));break;case"namecheap":t.push(o("API User","config.api_user",{allowInput:J}),o("API Key","config.api_key",{allowInput:J}));break;case"ns1":case"namesilo":case"bunny":t.push(o("API Key","config.api_key",{allowInput:J}));break;case"cloudns":t.push(o("Auth ID","config.auth_id",{allowInput:J}),o("Auth Password","config.auth_password",{allowInput:J}));break;case"aws":case"jdcloud":t.push(o("Access Key ID","config.access_key_id",{allowInput:J}),o("Secret Access Key","config.secret_access_key",{allowInput:J}));break;case"azure":t.push(o("Tenant ID","config.tenant_id",{allowInput:J}),o("Client ID","config.client_id",{allowInput:J}),o("Client Secret","config.client_secret",{allowInput:J}),o("Environment","config.environment",{allowInput:J,placeholder:"public"}));break;case"namedotcom":t.push(o("Username","config.username",{allowInput:J}),o("API Token","config.api_token",{allowInput:J}));break;case"gcore":t.push(o("API Token","config.api_token",{allowInput:J}))}return t}));I((()=>g.value.type),(e=>{switch(e){case"ssh":g.value.config={host:"",port:22,user:"root",mode:"password",password:""};break;case"1panel":case"btpanel":case"btwaf":g.value.config={url:"",api_key:"",ignore_ssl:"0"};break;case"aliyun":g.value.config={access_key_id:"",access_key_secret:""};break;case"baidu":case"huaweicloud":g.value.config={access_key:"",secret_key:""};break;case"cloudflare":g.value.config={email:"",api_key:""};break;case"tencentcloud":g.value.config={secret_id:"",secret_key:""};break;case"godaddy":g.value.config={api_key:"",api_secret:""};break;case"qiniu":g.value.config={access_key:"",access_secret:""};break;case"namecheap":g.value.config={api_user:"",api_key:""};break;case"ns1":case"namesilo":case"bunny":g.value.config={api_key:""};break;case"cloudns":g.value.config={auth_id:"",auth_password:""};break;case"aws":case"jdcloud":g.value.config={access_key_id:"",secret_access_key:""};break;case"azure":g.value.config={tenant_id:"",client_id:"",client_secret:"",environment:""};break;case"namedotcom":g.value.config={username:"",api_token:""};break;case"gcore":g.value.config={api_token:""}}}));const L=({option:e})=>i(F,{class:"w-full"},{default:()=>[e.label?O(e):i("span",{class:"text-[1.4rem] text-gray-400"},[s("t_0_1745833934390")])]}),O=e=>i(F,{justify:"space-between",class:"w-[38rem]"},{default:()=>[i(F,{align:"center",size:"small"},{default:()=>[i(V,{icon:`resources-${e.value}`,size:"1.6rem"},null),i(K,null,{default:()=>[e.label]})]}),i(F,{class:"pr-[1rem]"},{default:()=>[e.access&&e.access.map((e=>i(u,{type:"dns"===e?"success":"info",size:"small",key:e},{default:()=>[ae[e]]})))]})]}),{component:R,fetch:D}=A({config:S,defaultValue:g,request:async(e,a)=>{try{const a={...e,config:JSON.stringify(e.config)};if("id"in e){const{id:e,name:t,config:s}=a;await ie({id:e.toString(),name:t,config:s})}else await ne(a)}catch(t){throw oe(new Error(s("t_4_1746667590873")))}},rules:q});return r((async e=>{try{n(),await D(),ce(),e()}catch(a){return oe(a)}finally{c()}})),{ApiManageForm:R}};const pe=n({name:"AuthApiManage",setup(){const{ApiTable:e,ApiTablePage:a,param:t,fetch:r,total:n,openAddForm:c}=le(),o=q(["contentPadding","borderColor","headerHeight","iconColorHover"]);return()=>i("div",{class:"h-full flex flex-col",style:o.value},[i("div",{class:"mx-auto max-w-[1600px] w-full p-6"},[i(G,null,{headerLeft:()=>{let e;return i(_,{type:"primary",size:"large",class:"px-5",onClick:c},"function"==typeof(a=e=s("t_0_1745289355714"))||"[object Object]"===Object.prototype.toString.call(a)&&!g(a)?e:{default:()=>[e]});var a},headerRight:()=>i(k,{value:t.value.search,"onUpdate:value":e=>t.value.search=e,onKeydown:e=>{"Enter"===e.key&&r()},onClear:()=>Q((()=>r()),100),placeholder:s("t_0_1745289808449"),clearable:!0,size:"large",class:"min-w-[300px]"},{suffix:()=>i("div",{class:"flex items-center cursor-pointer",onClick:r},[i($,{class:"text-[var(--text-color-3)] w-[1.6rem] font-bold"},null)])}),content:()=>i("div",{class:"rounded-lg"},[i(e,{size:"medium"},{empty:()=>i(W,{addButtonText:s("t_0_1745289355714"),onAddClick:c},null)})]),footerRight:()=>i("div",{class:"mt-4 flex justify-end"},[i(a,null,{prefix:()=>i("span",null,[s("t_15_1745227839354"),j(" "),n.value,j(" "),s("t_16_1745227838930")])})])})])])}});export{pe as default};
