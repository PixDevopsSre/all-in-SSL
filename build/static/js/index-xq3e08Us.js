var e=Object.defineProperty,t=(t,n,a)=>((t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a)(t,"symbol"!=typeof n?n+"":n,a);import{f as n,q as a,d as o,h as r,j as l,k as i,b3 as s,n as d,aR as u,o as c,g as p,s as v,b4 as f,z as h,aY as _,a_ as m,aQ as y,b5 as g,e as b,p as w,b6 as N,aM as x,b7 as k,N as C,b8 as S,b9 as j,v as z,b1 as $,y as A,U as O,W as R,X as I,ba as F,bb as E,bc as D,bd as M,be as q,bf as B,bg as P,bh as V,bi as T,bj as U,bk as L,bl as H,bm as Z,bn as W,r as J,bo as G,bp as Y,bq as K,br as X,a6 as Q,a7 as ee,$ as te,a as ne,a1 as ae,aV as oe,c as re,a2 as le,ap as ie,an as se,am as de,B as ue,i as ce,al as pe,T as ve,ac as fe,ao as he,aq as _e,ar as me,ak as ye,aD as ge,Z as be,bs as we,bt as Ne,ad as xe,bu as ke,aA as Ce,F as Se,bv as je,u as ze,Y as $e,b as Ae,bw as Oe,bx as Re,aF as Ie,a3 as Fe,by as Ee}from"./main-TC3Bu45J.js";import{_ as De,i as Me,u as qe,N as Be,a as Pe}from"./index-jviZh_iP.js";import{_ as Ve,c as Te,d as Ue,t as Le,e as He,w as Ze,W as We,b as Je,a as Ge,N as Ye}from"./business-CSi1hkxo.js";import{u as Ke,a as Xe}from"./index-Cdsjg_sg.js";import{D as Qe}from"./index-Dj-kEiyX.js";import{f as et,h as tt}from"./access-CVoV-9UZ.js";import{S as nt}from"./index-OvFH652L.js";import{n as at}from"./utils-CRt-4gJj.js";import{T as ot}from"./index-DF0RwvD-.js";import{A as rt}from"./data-CXwlriQE.js";import{N as lt,a as it}from"./Tabs-CNL_If9W.js";import{N as st}from"./index-BqQRKdJ8.js";import{u as dt,g as ut}from"./cert-BrfOSOLb.js";import{f as ct}from"./useStore-B7wwrEXS.js";import"./useStore-BUVQMv4E.js";import"./index-C9x9Ia4N.js";import"./setting-BqHdEYrN.js";import"./throttle-CQkMUevy.js";const pt=n("input-group-label","\n position: relative;\n user-select: none;\n -webkit-user-select: none;\n box-sizing: border-box;\n padding: 0 12px;\n display: inline-block;\n border-radius: var(--n-border-radius);\n background-color: var(--n-group-label-color);\n color: var(--n-group-label-text-color);\n font-size: var(--n-font-size);\n line-height: var(--n-height);\n height: var(--n-height);\n flex-shrink: 0;\n white-space: nowrap;\n transition: \n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n",[a("border","\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n border-radius: inherit;\n border: var(--n-group-label-border);\n transition: border-color .3s var(--n-bezier);\n ")]),vt=o({name:"InputGroupLabel",props:Object.assign(Object.assign({},i.props),{size:{type:String,default:"medium"},bordered:{type:Boolean,default:void 0}}),setup(e){const{mergedBorderedRef:t,mergedClsPrefixRef:n,inlineThemeDisabled:a}=l(e),o=i("Input","-input-group-label",pt,s,e,n),r=d((()=>{const{size:t}=e,{common:{cubicBezierEaseInOut:n},self:{groupLabelColor:a,borderRadius:r,groupLabelTextColor:l,lineHeight:i,groupLabelBorder:s,[u("fontSize",t)]:d,[u("height",t)]:c}}=o.value;return{"--n-bezier":n,"--n-group-label-color":a,"--n-group-label-border":s,"--n-border-radius":r,"--n-group-label-text-color":l,"--n-font-size":d,"--n-line-height":i,"--n-height":c}})),p=a?c("input-group-label",d((()=>e.size[0])),r,e):void 0;return{mergedClsPrefix:n,mergedBordered:t,cssVars:a?void 0:r,themeClass:null==p?void 0:p.themeClass,onRender:null==p?void 0:p.onRender}},render(){var e,t,n;const{mergedClsPrefix:a}=this;return null===(e=this.onRender)||void 0===e||e.call(this),r("div",{class:[`${a}-input-group-label`,this.themeClass],style:this.cssVars},null===(n=(t=this.$slots).default)||void 0===n?void 0:n.call(t),this.mergedBordered?r("div",{class:`${a}-input-group-label__border`}):null)}}),ft=n("steps","\n width: 100%;\n display: flex;\n",[n("step","\n position: relative;\n display: flex;\n flex: 1;\n ",[p("disabled","cursor: not-allowed"),p("clickable","\n cursor: pointer;\n "),v("&:last-child",[n("step-splitor","display: none;")])]),n("step-splitor","\n background-color: var(--n-splitor-color);\n margin-top: calc(var(--n-step-header-font-size) / 2);\n height: 1px;\n flex: 1;\n align-self: flex-start;\n margin-left: 12px;\n margin-right: 12px;\n transition:\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n "),n("step-content","flex: 1;",[n("step-content-header","\n color: var(--n-header-text-color);\n margin-top: calc(var(--n-indicator-size) / 2 - var(--n-step-header-font-size) / 2);\n line-height: var(--n-step-header-font-size);\n font-size: var(--n-step-header-font-size);\n position: relative;\n display: flex;\n font-weight: var(--n-step-header-font-weight);\n margin-left: 9px;\n transition:\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n ",[a("title","\n white-space: nowrap;\n flex: 0;\n ")]),a("description","\n color: var(--n-description-text-color);\n margin-top: 12px;\n margin-left: 9px;\n transition:\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n ")]),n("step-indicator","\n background-color: var(--n-indicator-color);\n box-shadow: 0 0 0 1px var(--n-indicator-border-color);\n height: var(--n-indicator-size);\n width: var(--n-indicator-size);\n border-radius: 50%;\n display: flex;\n align-items: center;\n justify-content: center;\n transition:\n background-color .3s var(--n-bezier),\n box-shadow .3s var(--n-bezier);\n ",[n("step-indicator-slot","\n position: relative;\n width: var(--n-indicator-icon-size);\n height: var(--n-indicator-icon-size);\n font-size: var(--n-indicator-icon-size);\n line-height: var(--n-indicator-icon-size);\n ",[a("index","\n display: inline-block;\n text-align: center;\n position: absolute;\n left: 0;\n top: 0;\n white-space: nowrap;\n font-size: var(--n-indicator-index-font-size);\n width: var(--n-indicator-icon-size);\n height: var(--n-indicator-icon-size);\n line-height: var(--n-indicator-icon-size);\n color: var(--n-indicator-text-color);\n transition: color .3s var(--n-bezier);\n ",[f()]),n("icon","\n color: var(--n-indicator-text-color);\n transition: color .3s var(--n-bezier);\n ",[f()]),n("base-icon","\n color: var(--n-indicator-text-color);\n transition: color .3s var(--n-bezier);\n ",[f()])])]),p("vertical","flex-direction: column;",[h("show-description",[v(">",[n("step","padding-bottom: 8px;")])]),v(">",[n("step","margin-bottom: 16px;",[v("&:last-child","margin-bottom: 0;"),v(">",[n("step-indicator",[v(">",[n("step-splitor","\n position: absolute;\n bottom: -8px;\n width: 1px;\n margin: 0 !important;\n left: calc(var(--n-indicator-size) / 2);\n height: calc(100% - var(--n-indicator-size));\n ")])]),n("step-content",[a("description","margin-top: 8px;")])])])])])]);function ht(e){return e.map(((e,t)=>function(e,t){return"object"!=typeof e||null===e||Array.isArray(e)?null:(e.props||(e.props={}),e.props.internalIndex=t+1,e)}(e,t)))}const _t=Object.assign(Object.assign({},i.props),{current:Number,status:{type:String,default:"process"},size:{type:String,default:"medium"},vertical:Boolean,"onUpdate:current":[Function,Array],onUpdateCurrent:[Function,Array]}),mt=b("n-steps"),yt=o({name:"Steps",props:_t,slots:Object,setup(e,{slots:t}){const{mergedClsPrefixRef:n,mergedRtlRef:a}=l(e),o=y("Steps",a,n),r=i("Steps","-steps",ft,g,e,n);return w(mt,{props:e,mergedThemeRef:r,mergedClsPrefixRef:n,stepsSlots:t}),{mergedClsPrefix:n,rtlEnabled:o}},render(){const{mergedClsPrefix:e}=this;return r("div",{class:[`${e}-steps`,this.rtlEnabled&&`${e}-steps--rtl`,this.vertical&&`${e}-steps--vertical`]},ht(_(m(this))))}}),gt=o({name:"Step",props:{status:String,title:String,description:String,disabled:Boolean,internalIndex:{type:Number,default:0}},slots:Object,setup(e){const t=z(mt,null);t||$("step","`n-step` must be placed inside `n-steps`.");const{inlineThemeDisabled:n}=l(),{props:a,mergedThemeRef:o,mergedClsPrefixRef:r,stepsSlots:i}=t,s=d((()=>a.vertical)),p=d((()=>{const{status:t}=e;if(t)return t;{const{internalIndex:t}=e,{current:n}=a;if(void 0===n)return"process";if(t<n)return"finish";if(t===n)return a.status||"process";if(t>n)return"wait"}return"process"})),v=d((()=>{const{value:e}=p,{size:t}=a,{common:{cubicBezierEaseInOut:n},self:{stepHeaderFontWeight:r,[u("stepHeaderFontSize",t)]:l,[u("indicatorIndexFontSize",t)]:i,[u("indicatorSize",t)]:s,[u("indicatorIconSize",t)]:d,[u("indicatorTextColor",e)]:c,[u("indicatorBorderColor",e)]:v,[u("headerTextColor",e)]:f,[u("splitorColor",e)]:h,[u("indicatorColor",e)]:_,[u("descriptionTextColor",e)]:m}}=o.value;return{"--n-bezier":n,"--n-description-text-color":m,"--n-header-text-color":f,"--n-indicator-border-color":v,"--n-indicator-color":_,"--n-indicator-icon-size":d,"--n-indicator-index-font-size":i,"--n-indicator-size":s,"--n-indicator-text-color":c,"--n-splitor-color":h,"--n-step-header-font-size":l,"--n-step-header-font-weight":r}})),f=n?c("step",d((()=>{const{value:e}=p,{size:t}=a;return`${e[0]}${t[0]}`})),v,a):void 0,h=d((()=>{if(e.disabled)return;const{onUpdateCurrent:t,"onUpdate:current":n}=a;return t||n?()=>{t&&A(t,e.internalIndex),n&&A(n,e.internalIndex)}:void 0}));return{stepsSlots:i,mergedClsPrefix:r,vertical:s,mergedStatus:p,handleStepClick:h,cssVars:n?void 0:v,themeClass:null==f?void 0:f.themeClass,onRender:null==f?void 0:f.onRender}},render(){const{mergedClsPrefix:e,onRender:t,handleStepClick:n,disabled:a}=this,o=N(this.$slots.default,(t=>{const n=t||this.description;return n?r("div",{class:`${e}-step-content__description`},n):null}));return null==t||t(),r("div",{class:[`${e}-step`,a&&`${e}-step--disabled`,!a&&n&&`${e}-step--clickable`,this.themeClass,o&&`${e}-step--show-description`,`${e}-step--${this.mergedStatus}-status`],style:this.cssVars,onClick:n},r("div",{class:`${e}-step-indicator`},r("div",{class:`${e}-step-indicator-slot`},r(k,null,{default:()=>N(this.$slots.icon,(t=>{const{mergedStatus:n,stepsSlots:a}=this;return"finish"!==n&&"error"!==n?t||r("div",{key:this.internalIndex,class:`${e}-step-indicator-slot__index`},this.internalIndex):"finish"===n?r(C,{clsPrefix:e,key:"finish"},{default:()=>x(a["finish-icon"],(()=>[r(S,null)]))}):"error"===n?r(C,{clsPrefix:e,key:"error"},{default:()=>x(a["error-icon"],(()=>[r(j,null)]))}):null}))})),this.vertical?r("div",{class:`${e}-step-splitor`}):null),r("div",{class:`${e}-step-content`},r("div",{class:`${e}-step-content-header`},r("div",{class:`${e}-step-content-header__title`},x(this.$slots.title,(()=>[this.title]))),this.vertical?null:r("div",{class:`${e}-step-splitor`})),o))}}),bt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},wt=o({name:"ArrowLeftOutlined",render:function(e,t){return R(),O("svg",bt,t[0]||(t[0]=[I("path",{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 0 0 0 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z",fill:"currentColor"},null,-1)]))}}),Nt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},xt=o({name:"SaveOutlined",render:function(e,t){return R(),O("svg",Nt,t[0]||(t[0]=[I("path",{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144s144-64.5 144-144s-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80s80 35.8 80 80s-35.8 80-80 80z",fill:"currentColor"},null,-1)]))}}),kt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},Ct=o({name:"SearchOutlined",render:function(e,t){return R(),O("svg",kt,t[0]||(t[0]=[I("path",{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1c-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z",fill:"currentColor"},null,-1)]))}}),St={"@@functional/placeholder":!0},jt=Number.isInteger||function(e){return(e|0)===e};function zt(e,t){var n=e<0?t.length+e:e;return F(t)?t.charAt(n):t[n]}var $t=E((function(e,t){if(null!=t)return jt(e)?zt(e,t):t[e]}));function At(e,t,n){for(var a=0,o=n.length;a<o;){if((t=e["@@transducer/step"](t,n[a]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}a+=1}return e["@@transducer/result"](t)}var Ot=E((function(e,t){return D(e.length,(function(){return e.apply(t,arguments)}))}));function Rt(e,t,n){for(var a=n.next();!a.done;){if((t=e["@@transducer/step"](t,a.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}a=n.next()}return e["@@transducer/result"](t)}function It(e,t,n,a){return e["@@transducer/result"](n[a](Ot(e["@@transducer/step"],e),t))}var Ft=M(At,It,Rt),Et=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},e}();function Dt(e){return new Et(e)}var Mt=De((function(e,t,n){return Ft("function"==typeof e?Dt(e):e,t,n)}));function qt(e){return function e(t){for(var n,a,o,r=[],l=0,i=t.length;l<i;){if(q(t[l]))for(o=0,a=(n=e(t[l])).length;o<a;)r[r.length]=n[o],o+=1;else r[r.length]=t[l];l+=1}return r}}function Bt(e,t,n){if(n||(n=new Pt),o=typeof(a=e),null==a||"object"!=o&&"function"!=o)return e;var a,o,r=function(t){var a=n.get(e);if(a)return a;for(var o in n.set(e,t),e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};switch(B(e)){case"Object":return r(Object.create(Object.getPrototypeOf(e)));case"Array":return r(Array(e.length));case"Date":return new Date(e.valueOf());case"RegExp":return Ve(e);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return e.slice();default:return e}}var Pt=function(){function e(){this.map={},this.length=0}return e.prototype.set=function(e,t){var n=this.hash(e),a=this.map[n];a||(this.map[n]=a=[]),a.push([e,t]),this.length+=1},e.prototype.hash=function(e){var t=[];for(var n in e)t.push(Object.prototype.toString.call(e[n]));return t.join()},e.prototype.get=function(e){if(this.length<=180)for(var t in this.map)for(var n=this.map[t],a=0;a<n.length;a+=1){if((r=n[a])[0]===e)return r[1]}else{var o=this.hash(e);if(n=this.map[o])for(a=0;a<n.length;a+=1){var r;if((r=n[a])[0]===e)return r[1]}}},e}();function Vt(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function Tt(e,t){return function(){var n=arguments.length;if(0===n)return t();var a=arguments[n-1];return P(a)||"function"!=typeof a[e]?t.apply(this,arguments):a[e].apply(a,Array.prototype.slice.call(arguments,0,n-1))}}var Ut=V(Tt("tail",De(Tt("slice",(function(e,t,n){return Array.prototype.slice.call(n,e,t)})))(1,1/0)));var Lt=function(){function e(e,t,n,a){this.valueFn=e,this.valueAcc=t,this.keyFn=n,this.xf=a,this.inputs={}}return e.prototype["@@transducer/init"]=T.init,e.prototype["@@transducer/result"]=function(e){var t;for(t in this.inputs)if(U(t,this.inputs)&&(e=this.xf["@@transducer/step"](e,this.inputs[t]))["@@transducer/reduced"]){e=e["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var n=this.keyFn(t);return this.inputs[n]=this.inputs[n]||[n,Bt(this.valueAcc)],this.inputs[n][1]=this.valueFn(this.inputs[n][1],t),e},e}();function Ht(e,t,n){return function(a){return new Lt(e,t,n,a)}}var Zt=L(4,[],H([],Ht,(function(e,t,n,a){var o=Dt((function(a,o){var r=n(o),l=e(U(r,a)?a[r]:Bt(t),o);return l&&l["@@transducer/reduced"]?Te(a):(a[r]=l,a)}));return Ft(o,{},a)}))),Wt=function(){function e(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return e.prototype.add=function(e){return!Jt(e,!0,this)},e.prototype.has=function(e){return Jt(e,!1,this)},e}();function Jt(e,t,n){var a,o=typeof e;switch(o){case"string":case"number":return 0===e&&1/e==-1/0?!!n._items["-0"]||(t&&(n._items["-0"]=!0),!1):null!==n._nativeSet?t?(a=n._nativeSet.size,n._nativeSet.add(e),n._nativeSet.size===a):n._nativeSet.has(e):o in n._items?e in n._items[o]||(t&&(n._items[o][e]=!0),!1):(t&&(n._items[o]={},n._items[o][e]=!0),!1);case"boolean":if(o in n._items){var r=e?1:0;return!!n._items[o][r]||(t&&(n._items[o][r]=!0),!1)}return t&&(n._items[o]=e?[!1,!0]:[!0,!1]),!1;case"function":return null!==n._nativeSet?t?(a=n._nativeSet.size,n._nativeSet.add(e),n._nativeSet.size===a):n._nativeSet.has(e):o in n._items?!!Ue(e,n._items[o])||(t&&n._items[o].push(e),!1):(t&&(n._items[o]=[e]),!1);case"undefined":return!!n._items[o]||(t&&(n._items[o]=!0),!1);case"object":if(null===e)return!!n._items.null||(t&&(n._items.null=!0),!1);default:return(o=Object.prototype.toString.call(e))in n._items?!!Ue(e,n._items[o])||(t&&n._items[o].push(e),!1):(t&&(n._items[o]=[e]),!1)}}var Gt=V(qt()),Yt=V((function(e){return Z(e.length,(function(t,n){var a=Array.prototype.slice.call(arguments,0);return a[0]=n,a[1]=t,e.apply(this,a)}))})),Kt=E(Tt("groupBy",Zt((function(e,t){return e.push(t),e}),[]))),Xt=E((function(e,t){return e>=t})),Qt=E((function(e,t){if(0===e.length||W(t))return!1;for(var n=t,a=0;a<e.length;){if(W(n)||!U(e[a],n))return!1;n=n[e[a]],a+=1}return!0})),en=E((function(e,t){return Qt([e],t)})),tn=Zt((function(e,t){return t}),null),nn=function(){function e(e,t){this.xf=t,this.f=e,this.set=new Wt}return e.prototype["@@transducer/init"]=T.init,e.prototype["@@transducer/result"]=T.result,e.prototype["@@transducer/step"]=function(e,t){return this.set.add(this.f(t))?this.xf["@@transducer/step"](e,t):e},e}();function an(e){return function(t){return new nn(e,t)}}var on=E(H([],an,(function(e,t){for(var n,a,o=new Wt,r=[],l=0;l<t.length;)n=e(a=t[l]),o.add(n)&&r.push(a),l+=1;return r})))(Me);function rn(e,t){for(var n=t,a=0;a<e.length;a+=1){if(null==n)return;var o=e[a];n=jt(o)?zt(o,n):n[o]}return n}var ln=E((function(e,t){return e<=t})),sn=E(rn),dn=E((function(e,t){for(var n=0,a=Math.min(e.length,t.length),o={};n<a;)o[e[n]]=t[n],n+=1;return o}));const un=new class{constructor(){t(this,"validators",new Map),t(this,"validationResults",new Map),t(this,"valuesMap",new Map),t(this,"rulesMap",new Map)}register(e,t){this.validators.set(e,t),this.validate(e)}unregister(e){this.validators.delete(e),this.validationResults.delete(e),this.valuesMap.delete(e)}unregisterAll(){this.validators.clear(),this.validationResults.clear(),this.valuesMap.clear()}registerCompatValidator(e,t,n){n?this.valuesMap.set(e,{...n}):this.valuesMap.set(e,{});this.validators.set(e,(()=>this.validateWithRules(e,t)))}setValue(e,t,n){const a=this.valuesMap.get(e)||{};a[t]=n,this.valuesMap.set(e,a)}setValues(e,t){const n=this.valuesMap.get(e)||{};this.valuesMap.set(e,{...n,...t})}getValue(e,t){return(this.valuesMap.get(e)||{})[t]}getValues(e){return this.valuesMap.get(e)||{}}validateWithRules(e,t){const n=this.valuesMap.get(e)||{};for(const o in t){const e=Array.isArray(t[o])?t[o]:[t[o]],r=n[o];if(o in n)for(const t of e){if(t.required&&(null==r||""===r)){return{valid:!1,message:t.message||`${o}是必填项`}}if(null!=r&&""!==r||t.required){if(t.type&&!this.validateType(t.type,r)){return{valid:!1,message:t.message||`${o}的类型应为${t.type}`}}if(t.pattern&&!t.pattern.test(String(r))){return{valid:!1,message:t.message||`${o}格式不正确`}}if("string"===t.type||"array"===t.type){const e=r.length||0;if(void 0!==t.len&&e!==t.len){return{valid:!1,message:t.message||`${o}的长度应为${t.len}`}}if(void 0!==t.min&&e<t.min){return{valid:!1,message:t.message||`${o}的长度不应小于${t.min}`}}if(void 0!==t.max&&e>t.max){return{valid:!1,message:t.message||`${o}的长度不应大于${t.max}`}}}if("number"===t.type){if(void 0!==t.len&&r!==t.len){return{valid:!1,message:t.message||`${o}应等于${t.len}`}}if(void 0!==t.min&&r<t.min){return{valid:!1,message:t.message||`${o}不应小于${t.min}`}}if(void 0!==t.max&&r>t.max){return{valid:!1,message:t.message||`${o}不应大于${t.max}`}}}if(t.enum&&!t.enum.includes(r)){return{valid:!1,message:t.message||`${o}的值不在允许范围内`}}if(t.whitespace&&"string"===t.type&&!r.trim()){return{valid:!1,message:t.message||`${o}不能只包含空白字符`}}if(t.validator)try{const e=t.validator(t,r,void 0);if(!1===e){return{valid:!1,message:t.message||`${o}验证失败`}}if(e instanceof Error)return{valid:!1,message:e.message};if(Array.isArray(e)&&e.length>0&&e[0]instanceof Error)return{valid:!1,message:e[0].message}}catch(a){return{valid:!1,message:a instanceof Error?a.message:`${o}验证出错`}}}}}return{valid:!0,message:""}}validateType(e,t){switch(e){case"string":return"string"==typeof t;case"number":return"number"==typeof t&&!isNaN(t);case"boolean":return"boolean"==typeof t;case"method":return"function"==typeof t;case"regexp":return t instanceof RegExp;case"integer":return"number"==typeof t&&Number.isInteger(t);case"float":return"number"==typeof t&&!Number.isInteger(t);case"array":return Array.isArray(t);case"object":return"object"==typeof t&&!Array.isArray(t)&&null!==t;case"enum":return!0;case"date":return t instanceof Date;case"url":try{return new URL(t),!0}catch(n){return!1}case"email":return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t);default:return!0}}validate(e){const t=this.validators.get(e);if(t){const n=t();return this.validationResults.set(e,n),n}return{valid:!1,message:""}}validateAll(){let e=!0;const t={};return this.validators.forEach(((n,a)=>{const o=this.validate(a);t[a]=o,o.valid||(e=!1)})),{valid:e,results:t}}getValidationResult(e){return this.validationResults.get(e)||{valid:!0,message:""}}};function cn(){const e=J({valid:!1,message:""});return{validationResult:e,registerValidator:(t,n)=>{un.register(t,n),e.value=un.getValidationResult(t)},registerCompatValidator:(t,n,a)=>{un.registerCompatValidator(t,n,a),e.value=un.getValidationResult(t)},setFieldValue:(e,t,n)=>{un.setValue(e,t,n)},setFieldValues:(e,t)=>{un.setValues(e,t)},getFieldValue:(e,t)=>un.getValue(e,t),getFieldValues:e=>un.getValues(e),validate:t=>{const n=un.validate(t);return e.value=n,n},unregisterValidator:e=>{un.unregister(e)},validator:un}}G(((e,t)=>{const n=new Date(e),a=new Date(t),o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),r=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()-o.getTime();return Math.floor(r/864e5)}));G(((e,t,n)=>{const a=new Date(e).getTime(),o=new Date(t).getTime(),r=new Date(n).getTime();return a>=o&&a<=r}));G(((e,t)=>{const n=new Date(t);return n.setDate(n.getDate()+e),n})),K(String),G(((e,t)=>tn($t(e),t))),G(((e,t)=>Le(e,t))),G(((e,t)=>He(Yt(en)(e),t))),G(((e,t,n)=>X(Xt(St,e),ln(St,t))(n))),G(((e,t)=>Object.fromEntries(Object.entries(t).filter((([t,n])=>e(n)))))),G(((e,t)=>Kt($t(e),t))),G(((e,t)=>K(sn(e),t))),function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");D(arguments[0].length,Mt(Vt,arguments[0],Ut(arguments)))}(Gt,on);const pn=(e,t,n=!0)=>{const a={...e};for(const o in t)if(t.hasOwnProperty(o)){const r=t[o],l=e[o];Array.isArray(r)&&Array.isArray(l)?a[o]=n?[...l,...r]:r:vn(r)&&vn(l)?a[o]=pn(l,r):a[o]=r}return a},vn=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),fn=e=>JSON.parse(JSON.stringify(e)),hn=[];for(let Io=0;Io<256;++Io)hn.push((Io+256).toString(16).slice(1));let _n;const mn=new Uint8Array(16);const yn={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function gn(e,t,n){var a;if(yn.randomUUID&&!e)return yn.randomUUID();const o=(e=e||{}).random??(null==(a=e.rng)?void 0:a.call(e))??function(){if(!_n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");_n=crypto.getRandomValues.bind(crypto)}return _n(mn)}();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(e,t=0){return(hn[e[t+0]]+hn[e[t+1]]+hn[e[t+2]]+hn[e[t+3]]+"-"+hn[e[t+4]]+hn[e[t+5]]+"-"+hn[e[t+6]]+hn[e[t+7]]+"-"+hn[e[t+8]]+hn[e[t+9]]+"-"+hn[e[t+10]]+hn[e[t+11]]+hn[e[t+12]]+hn[e[t+13]]+hn[e[t+14]]+hn[e[t+15]]).toLowerCase()}(o)}const bn="start",wn="branch",Nn="condition",xn="execute_result_branch",kn="execute_result_condition",Cn="upload",Sn="notify",jn="apply",zn="deploy",$n={},An=e=>pn({title:{name:"",color:"#FFFFFF",bgColor:"#3CB371"},icon:{name:"",color:"#3CB371"},operateNode:{add:!0,sort:1,addBranch:!1,edit:!0,remove:!0,onSupportNode:[]},isHasDrawer:!1,defaultNode:{}},e);$n[bn]=()=>An({title:{name:"开始"},operateNode:{onSupportNode:[xn],remove:!1,edit:!1,add:!1},defaultNode:{id:gn(),name:"开始",type:bn,config:{exec_type:"manual"},childNode:null}}),$n[jn]=()=>An({title:{name:"申请"},icon:{name:jn},operateNode:{sort:1},defaultNode:{id:gn(),name:"申请",type:jn,config:{domains:"",email:"",eabId:"",ca:"letsencrypt",proxy:"",end_day:30,provider:"",provider_id:"",algorithm:"RSA2048",skip_check:0},childNode:null}}),$n[Cn]=()=>An({title:{name:"上传"},icon:{name:Cn},operateNode:{sort:2,onSupportNode:[xn]},defaultNode:{id:gn(),name:"上传",type:Cn,config:{cert_id:"",cert:"",key:""},childNode:null}}),$n[zn]=()=>An({title:{name:"部署"},icon:{name:zn},operateNode:{sort:3},defaultNode:{id:gn(),name:"部署",type:zn,inputs:[],config:{provider:"",provider_id:"",skip:1,inputs:{fromNodeId:"",name:""}},childNode:null}}),$n[Sn]=()=>An({title:{name:"通知"},icon:{name:Sn},operateNode:{sort:4},defaultNode:{id:gn(),name:"通知",type:Sn,config:{provider:"",provider_id:"",subject:"",body:""},childNode:null}}),$n[wn]=()=>An({title:{name:"并行分支"},icon:{name:wn},operateNode:{sort:5,addBranch:!0},defaultNode:{id:gn(),name:"并行分支",type:wn,conditionNodes:[{id:gn(),name:"分支1",type:Nn,config:{},childNode:null},{id:gn(),name:"分支2",type:Nn,config:{},childNode:null}]}}),$n[Nn]=()=>An({title:{name:"分支1"},icon:{name:Nn},operateNode:{add:!1,onSupportNode:[xn]},defaultNode:{id:gn(),name:"分支1",type:Nn,icon:{name:Nn},config:{},childNode:null}}),$n[xn]=()=>An({title:{name:"执行结果分支"},icon:{name:wn},operateNode:{sort:7,onSupportNode:[xn]},defaultNode:{id:gn(),name:"执行结果分支",type:xn,conditionNodes:[{id:gn(),name:"若当前节点执行成功…",type:kn,icon:{name:"success"},config:{type:"success"},childNode:null},{id:gn(),name:"若当前节点执行失败…",type:kn,icon:{name:"error"},config:{type:"fail"},childNode:null}]}}),$n[kn]=()=>An({title:{name:"执行结构条件"},icon:{name:wn},operateNode:{add:!1,onSupportNode:[xn]},defaultNode:{id:gn(),name:"若前序节点执行失败…",type:kn,icon:{name:"SUCCESS"},config:{type:"SUCCESS"},childNode:null}});const On={name:"",childNode:{id:"start-1",name:"开始",type:"start",config:{exec_type:"auto",type:"day",hour:1,minute:0},childNode:{id:"apply-1",name:"申请证书",type:"apply",config:{domains:"",email:"",eabId:"",ca:"letsencrypt",proxy:"",end_day:30,provider:"",provider_id:"",algorithm:"RSA2048",skip_check:0},childNode:{id:"deploy-1",name:"部署",type:"deploy",inputs:[],config:{provider:"",provider_id:"",skip:1,inputs:{fromNodeId:"",name:""}},childNode:{id:"execute",name:"执行结果",type:"execute_result_branch",config:{fromNodeId:"deploy-1"},conditionNodes:[{id:"execute-success",name:"执行成功",type:"execute_result_condition",config:{fromNodeId:"",type:"success"}},{id:"execute-failure",name:"执行失败",type:"execute_result_condition",config:{fromNodeId:"",type:"fail"}}],childNode:{id:"notify-1",name:"通知任务",type:"notify",config:{provider:"",provider_id:"",subject:"",body:""}}}}}}},Rn=Q("flow-store",(()=>{const e=J({id:"",name:"",childNode:{id:"start-1",name:"开始",type:"start",config:{exec_type:"manual"},childNode:null}}),t=J(100),n=J(!1),a=J([]),o=J([]),r=J(null),l=J(null),i=J(null),s=J(null),u=J(null),c=d((()=>a.value.filter((e=>!o.value.includes(e.type))))),p=d((()=>s.value?h(e.value.childNode,s.value):null)),v=d((()=>p.value?p.value.name:te("t_6_1744861190121"))),f=()=>{const t=JSON.parse(JSON.stringify(On));t.name="工作流（"+((e,t="yyyy-MM-dd HH:mm:ss")=>{const n=Number(e)&&10===e.toString().length?new Date(1e3*Number(e)):new Date(e),a=dn(["yyyy","MM","dd","HH","mm","ss"],[n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()]);return Mt(((e,t)=>{const n=a[t],o="yyyy"!==t&&n<10?`0${n}`:`${n}`;return e.replace(new RegExp(t,"g"),o)}),t,Y(a))})(new Date,"yyyy/MM/dd HH:mm:ss")+"）",e.value=t},h=(e,t)=>{var n;if(e.id===t)return e;if(e.childNode){const n=h(e.childNode,t);if(n)return n}if(null==(n=e.conditionNodes)?void 0:n.length)for(const a of e.conditionNodes){const e=h(a,t);if(e)return e}return null},_=t=>h(e.value.childNode,t),m=(e,t,n,a=null)=>{var o;if(e.id===t)return n(e,a),!0;if(e.childNode&&m(e.childNode,t,n,e))return!0;if(null==(o=e.conditionNodes)?void 0:o.length)for(const r of e.conditionNodes)if(m(r,t,n,e))return!0;return!1},y=(e,t)=>{if(!e)return null;const n=e[t];return n?"object"==typeof n&&null!==n?y(n,t):void 0:e};return{flowData:e,flowZoom:t,selectedNode:p,nodeTitle:v,selectedNodeId:s,isRefreshNode:u,advancedOptions:n,initFlowData:f,resetFlowData:()=>f(),getResultData:()=>pn({},e.value),updateFlowData:t=>{e.value=t},setflowZoom:e=>{1===e&&t.value>50?t.value-=10:2===e&&t.value<300&&(t.value+=10)},addNodeSelectList:a,nodeSelectList:c,excludeNodeSelectList:o,addNodeBtnRef:r,addNodeSelectRef:l,addNodeSelectPostion:i,getAddNodeSelect:()=>{a.value=[],Object.keys($n).forEach((e=>{var t;const n=$n[e]();(null==(t=n.operateNode)?void 0:t.add)&&a.value.push({title:{name:n.title.name},type:e,icon:{...n.icon||{}},selected:!1})}))},addExcludeNodeSelectList:e=>{o.value=e},clearExcludeNodeSelectList:()=>{o.value=[]},setShowAddNodeSelect:(e,t)=>{var n;if(o.value=(null==(n=$n[t]().operateNode)?void 0:n.onSupportNode)||[],e&&l.value&&r.value){const e=l.value.getBoundingClientRect().width,t=r.value.getBoundingClientRect().right,n=window.innerWidth;i.value=t+e>n?1:2}},addNode:(t,n,a={})=>{if(!_(t))return;let o=pn($n[n]().defaultNode,a);m(e.value.childNode,t,((e,a)=>{switch(n){case Nn:e.conditionNodes&&(o.name=`分支${e.conditionNodes.length+1}`,e.conditionNodes.push(o));break;case wn:case xn:n===xn&&(o={...o,config:{fromNodeId:t}}),o.conditionNodes[0].childNode=e.childNode,e.childNode=o;break;default:e.childNode&&(o.childNode=e.childNode),e.childNode=o}}))},removeNode:(t,n=!1)=>{if(_(t))return m(e.value.childNode,t,((a,o)=>{var r,l,i;if(!o)return;const{type:s,conditionNodes:d}=o;(null==(r=a.childNode)?void 0:r.type)===xn&&(null==(l=a.childNode)?void 0:l.config)&&(a.childNode.config.fromNodeId=o.id);const u=[Nn,kn,wn,xn];if(u.includes(a.type)||(null==(i=o.childNode)?void 0:i.id)!==t){if(u.includes(a.type))if(2===d.length)m(e.value.childNode,o.id,s===wn?(e,n)=>{const a=d.findIndex((e=>e.id===t)),o=e.childNode;if(-1!==a&&n){n.childNode=d[0===a?1:0].childNode;y(n,"childNode").childNode=o}}:(e,t)=>{var n;t&&((null==(n=null==o?void 0:o.childNode)?void 0:n.id)?t.childNode=o.childNode:t.childNode=void 0)});else{const e=o.conditionNodes.findIndex((e=>e.id===t));if(-1!==e)if(n)o.conditionNodes.splice(e,1);else{const t=o.conditionNodes[e];(null==t?void 0:t.childNode)?o.conditionNodes[e]=t.childNode:o.conditionNodes.splice(e,1)}}}else n?o.childNode=void 0:a.childNode?o.childNode=a.childNode:o.childNode=void 0})),e.value},updateNodeConfig:(t,n)=>{if(_(t))return m(e.value.childNode,t,(e=>{e.config=n})),e.value},updateNode:(t,n,a=!0)=>{if(_(t))return m(e.value.childNode,t,(e=>{const t=pn(e,n,a);Object.keys(t).forEach((n=>{n in e&&(e[n]=t[n])}))})),e.value},findApplyUploadNodesUp:(t,n=["apply","upload"])=>{const a=[],o=(e,t,n=[])=>{var a;if(e.id===t)return n;if(e.childNode){const a=[...n,e],r=o(e.childNode,t,a);if(r)return r}if(null==(a=e.conditionNodes)?void 0:a.length)for(const r of e.conditionNodes){const a=[...n,e],l=o(r,t,a);if(l)return l}return null},r=o(e.value.childNode,t);return r&&r.forEach((e=>{n.includes(e.type)&&a.push({name:e.name,id:e.id})})),a},checkFlowNodeChild:e=>{var t;const n=_(e);return!!n&&!(!n.childNode&&!(null==(t=n.conditionNodes)?void 0:t.length))},checkFlowInlineNode:t=>{const n=_(t);n&&"condition"===n.type&&m(e.value.childNode,t,(e=>{e.conditionNodes&&(e.conditionNodes=e.conditionNodes.filter((e=>e.id!==t)))}))}}})),In=()=>{const e=Rn(),t=ee(e);return{...e,...t}};function Fn(e,t,n){const{isRefreshNode:a}=In(),{registerCompatValidator:o,validate:r,validationResult:l,unregisterValidator:i}=cn(),s=ne(["warningColor","primaryColor"]),u=d((()=>l.value.valid?"var(--n-primary-color)":"var(--n-warning-color)"));ae((()=>a.value),(n=>{Ke((()=>{o(e.node.id,t,e.node.config),r(e.node.id),a.value=null}),500)}),{immediate:!0}),oe((()=>i(e.node.id)));return{validationResult:l,validColor:u,renderNode:()=>re("div",{style:s.value,class:"text-[12px]"},[re("div",{style:{color:u.value}},[n(l.value.valid,e.node.config)])])}}function En(e){return{required:(t,n,a="change")=>({required:!0,message:n||te("t_3_1747817612697",{nodeName:e,field:t}),trigger:a}),domain:(e="input")=>({required:!0,trigger:e,validator:(e,t)=>t?!!Je(t)||new Error(te("t_4_1747817613325")):new Error(te("t_0_1744958839535"))}),domainGroup:(e="input")=>({required:!0,trigger:e,validator:(e,t)=>t?!!We(t)||new Error(te("t_5_1747817619337")):new Error(te("t_0_1744958839535"))}),email:(e="input")=>({required:!0,trigger:e,validator:(e,t)=>t?!!Ze(t)||new Error(te("t_7_1747817613773")):new Error(te("t_6_1747817644358"))}),custom:(e,t="change")=>({required:!0,trigger:t,validator:e})}}const Dn=En(te("t_10_1747817611126")),Mn={domains:Dn.domainGroup(),email:Dn.email(),provider_id:Dn.required("provider_id",te("t_3_1745490735059")),end_day:Dn.custom(((e,t)=>!("number"!=typeof t||isNaN(t)||t<1)||new Error(te("t_9_1747990229640"))))};function qn(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ce(e)}const Bn=o({name:"CAProviderSelect",props:{path:{type:String,required:!0},value:{type:String,required:!0,default:""},ca:{type:String,required:!0},email:{type:String,required:!0},disabled:{type:Boolean,default:!1},customClass:{type:String,default:""}},emits:{"update:value":e=>!0,"update:email":e=>!0},setup(e,{emit:t}){const{isLoading:n,caProviderRef:a,param:o,handleUpdateValue:r,handleFilter:l,goToAddCAProvider:i,errorMessage:s,loadCAProviders:d}=function(e,t){const{handleError:n}=qe(),a=J({label:"",value:"",ca:"",email:""}),o=J([]),r=J(!1),l=J(""),i=()=>{var e,n,r,l;const i=o.value.find((e=>e.value===a.value.value));i?a.value={label:i.label,value:i.value,ca:i.ca,email:i.email}:o.value.length>0&&""===a.value.value&&(a.value={label:(null==(e=o.value[0])?void 0:e.label)||"",value:(null==(n=o.value[0])?void 0:n.value)||"",ca:(null==(r=o.value[0])?void 0:r.ca)||"",email:(null==(l=o.value[0])?void 0:l.email)||""}),""!==a.value.value&&t("update:email",a.value.email),t("update:value",{value:a.value.value,ca:a.value.ca,email:a.value.email})},s=e=>{a.value.value=e,i()},d=async()=>{r.value=!0,l.value="";try{const t={label:"Let's Encrypt",value:"",ca:"letsencrypt",email:""},{data:n}=await et({ca:""}).fetch(),a=(n||[]).map((e=>({label:e.name,value:e.id.toString(),ca:e.ca,email:e.mail})));o.value=[t,...a],e.value?s(e.value):i()}catch(t){l.value="string"==typeof t?t:te("t_3_1747990229599"),n(t)}finally{r.value=!1}};return ae((()=>e.value),(e=>{e!==a.value.value&&s(e)}),{immediate:!0}),le((()=>{d()})),{param:a,caProviderRef:o,isLoading:r,errorMessage:l,goToAddCAProvider:e=>{window.open(`/auto-deploy?type=${e}`,"_blank")},handleUpdateValue:s,loadCAProviders:d,handleFilter:(e,t)=>t.label.toLowerCase().includes(e.toLowerCase())}}(e,t),u=e=>re(Ye,{align:"center"},{default:()=>[re(nt,{icon:`cert-${e.ca}`,size:"2rem"},null),re(Ge,null,{default:()=>[e.label]})]});return()=>{let t,c;return re(Be,{show:n.value},{default:()=>[re(ie,{cols:24,class:e.customClass},{default:()=>[re(se,{span:13,label:te("t_0_1748052857931"),path:e.path},{default:()=>[re(de,{class:"flex-1 w-full",options:a.value,renderLabel:u,renderTag:({option:e})=>(({option:e})=>{let t;return re("div",{class:"flex items-center"},[e.label?u(e):re(Ge,{class:"text-[#aaa]"},qn(t=te("t_0_1747990228780"))?t:{default:()=>[t]})])})({option:e}),filterable:!0,filter:(e,t)=>l(e,t),placeholder:te("t_0_1747990228780"),value:o.value.value,onUpdateValue:r,disabled:e.disabled},{header:()=>re("div",{class:"flex items-center cursor-pointer hover:text-[#333] hover:bg-[#eee]",onClick:()=>i("addCAForm")},[te("t_1_1748052860539")]),empty:()=>re("span",{class:"text-[1.4rem]"},[s.value||te("t_2_1747990228008")])})]}),re(se,{span:11},{default:()=>[re(ue,{class:"mx-[8px]",onClick:()=>i("caManage"),disabled:e.disabled},qn(t=te("t_0_1747903670020"))?t:{default:()=>[t]}),re(ue,{onClick:()=>d(),loading:n.value,disabled:e.disabled},qn(c=te("t_0_1746497662220"))?c:{default:()=>[c]})]})]})]})}}}),Pn=o({name:"ApplyNodeDrawer",props:{node:{type:Object,default:()=>({id:"",config:{domains:"",email:"",eabId:"",ca:"",proxy:"",provider_id:"",provider:"",end_day:30,name_server:"",skip_check:0,algorithm:"RSA2048"}})}},setup(e){const{updateNodeConfig:t,advancedOptions:n,isRefreshNode:a}=In(),{confirm:o}=me(),{useFormInput:r,useFormSelect:l,useFormMore:i,useFormHelp:s,useFormSwitch:u}=pe(),c=J(fn(e.node.config)),p=d((()=>[r(te("t_17_1745227838561"),"domains",{placeholder:te("t_0_1745735774005"),allowInput:at,onInput:e=>{c.value.domains=e.replace(/，/g,",").replace(/;/g,",")}}),{type:"custom",render:()=>re(Qe,ve({type:"dns",path:"provider_id",value:c.value.provider_id,valueType:"value",isAddMode:!0},{"onUpdate:value":e=>{c.value.provider_id=e.value,c.value.provider=e.type}}),null)},{type:"custom",render:()=>re(Bn,ve({path:"eabId",value:c.value.eabId,email:c.value.email,ca:c.value.ca},{"onUpdate:value":e=>{c.value.eabId=e.value,c.value.ca=e.ca,e.value&&(c.value.email=e.email)}}),null)},r(te("t_68_1745289354676"),"email",{placeholder:te("t_2_1748052862259"),allowInput:at}),{type:"custom",render:()=>re(fe,{label:te("t_4_1747990227956"),path:"end_day"},{default:()=>[re("div",{class:"flex items-center"},[re("span",{class:"text-[1.4rem] mr-[1.2rem]"},[te("t_5_1747990228592")]),re(he,{value:c.value.end_day,"onUpdate:value":e=>c.value.end_day=e,showButton:!1,min:1,class:"w-[120px]"},null),re("span",{class:"text-[1.4rem] ml-[1.2rem]"},[te("t_6_1747990228465")])])]})},i(n),...n.value?[l(te("t_0_1747647014927"),"algorithm",[{label:"RSA2048",value:"RSA2048"},{label:"RSA3072",value:"RSA3072"},{label:"RSA4096",value:"RSA4096"},{label:"RSA8192",value:"RSA8192"},{label:"EC256",value:"EC256"},{label:"EC384",value:"EC384"}],{},{showRequireMark:!1}),r(te("t_7_1747990227761"),"proxy",{placeholder:te("t_8_1747990235316"),allowInput:at},{showRequireMark:!1}),r(te("t_0_1747106957037"),"name_server",{placeholder:te("t_1_1747106961747"),allowInput:at,onInput:e=>{c.value.name_server=e.replace(/，/g,",").replace(/;/g,",")}},{showRequireMark:!1}),u(te("t_2_1747106957037"),"skip_check",{checkedValue:1,uncheckedValue:0},{showRequireMark:!1})]:[],s([{content:te("t_0_1747040228657")},{content:te("t_1_1747040226143")}])])),{component:v,data:f,example:h}=_e({defaultValue:c,config:p,rules:Mn});return le((()=>{n.value=!1})),o((async n=>{var o;try{await(null==(o=h.value)?void 0:o.validate()),t(e.node.id,f.value),a.value=e.node.id,n()}catch(r){}})),()=>re("div",{class:"apply-node-drawer"},[re(v,{labelPlacement:"top"},null)])}});function Vn(){return{handleNodeClick:(e,t,n,a="60rem",o=!0)=>{var r;ye({title:`${null==(r=e.value)?void 0:r.name}${n||te("t_1_1745490731990")}`,area:a,component:()=>t(e.value),confirmText:te("t_2_1744861190040"),footer:o})}}}const Tn=o({name:"ApplyNode",props:{node:{type:Object,default:()=>({id:"",config:{}})}},setup(e,{expose:t}){const{renderNode:n}=Fn(e,Mn,((e,t)=>e?te("t_9_1747817611448")+(null==t?void 0:t.domains):te("t_9_1745735765287"))),{handleNodeClick:a}=Vn();return t({handleNodeClick:e=>a(e,(e=>re(Pn,{node:e},null)))}),n}}),Un=Object.freeze(Object.defineProperty({__proto__:null,default:Tn},Symbol.toStringTag,{value:"Module"})),Ln=En(te("t_11_1747817612051")),Hn={provider:Ln.required("provider",te("t_0_1746858920894")),provider_id:Ln.custom(((e,t)=>!!t||new Error(te("t_0_1746858920894")))),"inputs.fromNodeId":Ln.required("inputs.fromNodeId",te("t_3_1745748298161")),certPath:Ln.required("certPath",te("t_30_1746667591892"),"input"),keyPath:Ln.required("keyPath",te("t_31_1746667593074"),"input"),siteName:Ln.custom(((e,t)=>{if(!t)return new Error(te("t_1_1747296175494"));if("string"==typeof t){if(!t.trim())return new Error(te("t_1_1747296175494"))}else{if(!Array.isArray(t))return new Error(te("t_1_1747296175494"));if(0===t.length)return new Error(te("t_1_1747296175494"))}return!0}),"input"),site_id:Ln.required("site_id",te("t_24_1745735766826"),"input"),domain:Ln.custom(((e,t)=>t&&!!Je(t)||new Error(te("t_0_1744958839535"))),"input"),region:Ln.required("region",te("t_25_1745735766651"),"input"),bucket:Ln.required("bucket",te("t_26_1745735767144"),"input")};const Zn="all",Wn={};function Jn(e){const t=e.split("-")[0];return Wn[t]||Zn}function Gn(){const e=[];return Object.keys(rt).filter((e=>{const t=rt[e];return Array.isArray(t.type)&&t.type.includes("host")})).forEach((t=>{const n=rt[t],{icon:a}=n;if("hostRelated"in n&&n.hostRelated){const o=n.hostRelated;"default"in o&&o.default&&"name"in o.default&&e.push({label:o.default.name,value:t,category:Jn(t),icon:a}),Object.entries(o).forEach((([n,o])=>{if("default"!==n&&o&&"object"==typeof o&&"name"in o){const r=`${t}-${n}`;e.push({label:o.name,value:r,category:Jn(t),icon:a})}}))}})),e.sort(((e,t)=>{var n,a,o,r;const l=((null==(n=e.value)?void 0:n.toString())||"").split("-")[0],i=((null==(a=t.value)?void 0:a.toString())||"").split("-")[0],s=l?rt[l]:void 0,d=i?rt[i]:void 0,u=s&&"object"==typeof s&&"sort"in s&&s.sort||999,c=d&&"object"==typeof d&&"sort"in d&&d.sort||999;if(u!==c)return u-c;const p=(null==(o=e.label)?void 0:o.toString())||"",v=(null==(r=t.label)?void 0:r.toString())||"";return p.localeCompare(v)}))}function Yn(e){if(e===Zn)return te("t_7_1747271292060");for(const[t,n]of Object.entries(rt))if(n.icon===e)return"本地部署"===n.name?te("t_0_1747969933657"):n.name;return""}Object.entries(rt).forEach((([e,t])=>{var n;(null==(n=t.type)?void 0:n.includes("host"))&&t.icon&&(Wn[e]=t.icon)}));const Kn={configContainer:"_configContainer_11qz3_4",formContainer:"_formContainer_11qz3_9",leftPanel:"_leftPanel_11qz3_14",rightPanel:"_rightPanel_11qz3_21",searchBar:"_searchBar_11qz3_26",cardContainer:"_cardContainer_11qz3_31",optionCard:"_optionCard_11qz3_37",optionCardSelected:"_optionCardSelected_11qz3_42",cardContent:"_cardContent_11qz3_68",icon:"_icon_11qz3_73",iconSelected:"_iconSelected_11qz3_77",footer:"_footer_11qz3_82",footerButton:"_footerButton_11qz3_86"};function Xn(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ce(e)}const Qn=["btpanel-site","1panel-site"],ea=["btpanel-site"],ta=o({name:"DeployNodeDrawer",props:{node:{type:Object,default:()=>({id:"",inputs:[],config:{provider:"",provider_id:"",inputs:{fromNodeId:"",name:""},skip:1}})}},setup(e){const{updateNode:t,updateNodeConfig:n,findApplyUploadNodesUp:a,isRefreshNode:o}=In(),r=ne(["primaryColor","borderColor"]),{handleError:l}=qe(),i=be();we();const s=Ne(),u=function(){const{useFormInput:e,useFormTextarea:t,useFormSelect:n}=pe();return{input:(t,n,a={},o={})=>e(t,n,{placeholder:a.placeholder||te("t_0_1747817614953")+t,allowInput:at,...a},o),textarea:(e,n,a={},o={})=>t(e,n,{placeholder:a.placeholder||te("t_0_1747817614953")+e,rows:a.rows||3,...a},{showRequireMark:!1,...o}),select:(e,t,a,o={},r={})=>n(e,t,a,o,r),switch(e,t,n,a={}){const o=a.checkedText||te("t_1_1747817639034"),r=a.uncheckedText||te("t_2_1747817610671"),l=a.description||"";return{type:"custom",render:()=>re(fe,{label:e,path:t},{default:()=>{return[l&&re(Ge,null,(e=l,"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ce(e)?l:{default:()=>[l]})),re(ge,{value:n.value[t],"onUpdate:value":e=>n.value[t]=e,checkedValue:1,uncheckedValue:0,class:"mx-[.5rem]"},{checked:()=>o,unchecked:()=>r})];var e}})}},custom:e=>({type:"custom",render:e}),sshDeploy(){return[this.input(te("t_1_1747280813656"),"certPath",{placeholder:te("t_30_1746667591892")}),this.input(te("t_2_1747280811593"),"keyPath",{placeholder:te("t_31_1746667593074")}),this.textarea(te("t_3_1747280812067"),"beforeCmd",{placeholder:te("t_21_1745735769154"),rows:2}),this.textarea(te("t_4_1747280811462"),"afterCmd",{placeholder:te("t_22_1745735767366"),rows:2})]},siteDeploy(){return[this.input(te("t_0_1747296173751"),"siteName",{placeholder:te("t_0_1748589752275")})]},onePanelSiteDeploy(){return[this.input(te("t_6_1747280809615"),"site_id",{placeholder:te("t_24_1745735766826")})]},cdnDeploy(){return[this.input(te("t_17_1745227838561"),"domain",{placeholder:te("t_0_1744958839535")})]},wafDeploy(){return[this.input(te("t_17_1745227838561"),"domain",{placeholder:te("t_0_1744958839535")}),this.select(te("t_7_1747280808936"),"region",[{label:"cn-hangzhou",value:"cn-hangzhou"},{label:"ap-southeast-1",value:"ap-southeast-1"}],{placeholder:te("t_25_1745735766651"),defaultValue:"cn-hangzhou"})]},storageDeploy(){return[this.input(te("t_17_1745227838561"),"domain",{placeholder:te("t_0_1744958839535")}),this.input(te("t_7_1747280808936"),"region",{placeholder:te("t_25_1745735766651")}),this.input(te("t_8_1747280809382"),"bucket",{placeholder:te("t_26_1745735767144")})]},skipOption(e){return this.switch(te("t_9_1747280810169"),"skip",e,{checkedText:te("t_11_1747280809178"),uncheckedText:te("t_12_1747280809893"),description:te("t_10_1747280816952")})}}}(),c=Gn(),p=function(){const e=Array.from(new Set(Gn().map((e=>e.category)).filter(Boolean)));if(e.includes(Zn)){const t=e.indexOf(Zn);e.splice(t,1),e.unshift(Zn)}else e.unshift(Zn);return e.sort(((e,t)=>{var n,a;if(e===Zn)return-1;if(t===Zn)return 1;const o=Object.entries(rt).find((([t,n])=>n.icon===e)),r=Object.entries(rt).find((([e,n])=>n.icon===t));return((null==(n=null==o?void 0:o[1])?void 0:n.sort)||999)-((null==(a=null==r?void 0:r[1])?void 0:a.sort)||999)})).map((e=>({name:e,tab:Yn(e)})))}(),v=J([]),f=J([]),h=J(!1),_=J(1),m=J(!0),y=J("process"),g=J(Zn),b=J(""),w=J(fn(e.node.config)),N=J(function(){var e,t;const n=rt.localhost;return n&&Array.isArray(n.type)&&n.type.includes("host")?[{label:(null==(t=null==(e=n.hostRelated)?void 0:e.default)?void 0:t.name)||te("t_6_1747271296994"),value:"localhost"}]:[{label:te("t_6_1747271296994"),value:"localhost"}]}()),x=d((()=>{var e;return w.value.provider?te("t_4_1746858917773")+"："+(null==(e=c.find((e=>e.value===w.value.provider)))?void 0:e.label):te("t_19_1745735766810")})),k=d((()=>function(e,t,n){let a=[...e];if(t!==Zn&&(a=a.filter((e=>e.category===t))),n){const e=n.toLowerCase();a=a.filter((t=>{var n,a;return((null==(n=t.label)?void 0:n.toString().toLowerCase())||"").includes(e)||((null==(a=t.value)?void 0:a.toString().toLowerCase())||"").includes(e)}))}return a}(c,g.value,b.value))),C=d((()=>{const e=[];switch("localhost"!==w.value.provider?e.push(u.custom((()=>{const e={type:w.value.provider,path:"provider_id",value:w.value.provider_id,valueType:"value",isAddMode:!0,"onUpdate:value":e=>{""!==e.value&&""!==w.value.provider_id&&w.value.provider_id!==e.value&&Qn.includes(w.value.provider)&&(w.value.siteName=ea.includes(w.value.provider)?[]:""),w.value.provider_id=e.value,w.value.type=e.type}};return re(Qe,e,null)}))):e.push(u.select(te("t_0_1746754500246"),"provider",N.value)),e.push(u.select(te("t_1_1745748290291"),"inputs.fromNodeId",v.value,{onUpdateValue:(e,t)=>{w.value.inputs.fromNodeId=e,w.value.inputs.name=null==t?void 0:t.label}})),w.value.provider){case"localhost":case"ssh":e.push(...u.sshDeploy());break;case"btpanel-site":case"1panel-site":e.push(u.select(te("t_0_1747296173751"),"1panel-site"===w.value.provider?"site_id":"siteName",f.value,{placeholder:ea.includes(w.value.provider)?te("t_10_1747990232207"):te("t_0_1748586248783"),multiple:ea.includes(w.value.provider),filterable:!0,remote:!0,clearable:!0,loading:h.value,onSearch:S}));break;case"btwaf-site":case"btpanel-dockersite":case"btpanel-singlesite":case"safeline-site":e.push(...u.siteDeploy());break;case"tencentcloud-cdn":case"tencentcloud-waf":case"tencentcloud-teo":case"aliyun-cdn":case"baidu-cdn":case"qiniu-cdn":case"qiniu-oss":case"huaweicloud-cdn":e.push(...u.cdnDeploy());break;case"volcengine-cdn":case"volcengine-dcdn":e.push(u.input(te("t_17_1745227838561"),"domain",{placeholder:te("t_0_1744958839535")}),u.input(te("t_7_1747280808936"),"region",{placeholder:te("t_25_1745735766651")}));break;case"aliyun-waf":e.push(...u.wafDeploy());break;case"tencentcloud-cos":case"aliyun-oss":e.push(...u.storageDeploy())}return e.push(u.skipOption(w)),e}));ae((()=>w.value.provider_id),(()=>S("")));const S=Xe((async e=>{if(Qn.includes(w.value.provider)&&w.value.provider_id)try{h.value=!0;const{data:t}=await tt({id:w.value.provider_id.toString(),type:w.value.provider,search:e,limit:"100"}).fetch();f.value=null==t?void 0:t.map((({siteName:e,id:t})=>({label:e,value:t||e})))}catch(t){l(t),f.value=[]}finally{h.value=!1}}),1e3),j=async()=>{var t,n,o;if(!w.value.provider)return i.error(te("t_0_1746858920894"));"localhost"===w.value.provider&&delete w.value.provider_id,v.value=a(e.node.id).map((e=>({label:e.name,value:e.id}))),v.value.length?(null==(t=w.value.inputs)?void 0:t.fromNodeId)||(w.value.inputs={name:(null==(n=v.value[0])?void 0:n.label)||"",fromNodeId:(null==(o=v.value[0])?void 0:o.value)||""}):i.warning(te("t_3_1745748298161")),_.value++,m.value=!1},{component:z,example:$}=_e({config:C,defaultValue:w,rules:Hn}),A=()=>{_.value--,m.value=!0,w.value={},w.value.provider_id="",w.value.provider=""},O=async()=>{var a;try{await(null==(a=$.value)?void 0:a.validate());const r=fn(w.value);ea.includes(r.provider)&&r.siteName&&Array.isArray(r.siteName)&&(r.siteName=r.siteName.join(","));const l=r.inputs;n(e.node.id,{...r}),t(e.node.id,{inputs:[l]},!1),o.value=e.node.id,s()}catch(r){l(r)}};return le((()=>{w.value.provider&&(e.node.inputs&&(w.value.inputs=e.node.inputs[0]),Qn.includes(w.value.provider)&&("btpanel-site"===w.value.provider&&(w.value.siteName=w.value.siteName.split(",").filter(Boolean)),S("")),j())})),()=>{let e,t,n;return re("div",{class:Kn.container,style:r.value},[re(yt,{size:"small",current:_.value,status:y.value},{default:()=>[re(gt,{title:te("t_28_1745735766626"),description:x.value},null),re(gt,{title:te("t_29_1745735768933"),description:te("t_2_1745738969878")},null)]}),1===_.value&&re("div",{class:Kn.configContainer},[re("div",{class:Kn.leftPanel},[re(lt,{type:"bar",placement:"left",value:g.value,class:"h-[45rem]",onUpdateValue:e=>g.value=e},Xn(e=p.map((e=>re(it,{key:e.name,name:e.name,tab:e.tab},null))))?e:{default:()=>[e]})]),re("div",{class:Kn.rightPanel},[re("div",{class:Kn.searchBar},[re(xe,{value:b.value,onUpdateValue:e=>b.value=e,placeholder:te("t_14_1747280811231"),clearable:!0},{suffix:()=>re("div",{class:"flex items-center"},[re(Ct,{class:"text-[var(--text-color-3)] w-[1.6rem] cursor-pointer font-bold"},null)])})]),re(ke,{class:"!my-[1rem]"},null),re("div",{class:Kn.cardContainer},[k.value.map((e=>{var t;return re("div",{key:e.value,class:`${Kn.optionCard} ${w.value.provider===e.value?Kn.optionCardSelected:""}`,onClick:()=>{w.value.provider=e.value}},[re("div",{class:Kn.cardContent},[re(nt,{icon:`resources-${null==(t=e.icon)?void 0:t.replace(/-[a-z]+$/,"")}`,size:"2rem",class:`${Kn.icon} ${w.value.provider===e.value?Kn.iconSelected:""}`},null),re(Ge,{type:w.value.provider===e.value?"primary":"default",class:"text-center"},{default:()=>[e.label]})])])}))])])]),2===_.value&&re(Ce,{class:Kn.formContainer},{default:()=>[re(z,{labelPlacement:"top"},null)]}),re("div",{class:Kn.footer},[re(ue,{class:Kn.footerButton,onClick:s},Xn(t=te("t_4_1744870861589"))?t:{default:()=>[t]}),re(Se,{trigger:"hover",disabled:!!w.value.provider},{default:()=>[m.value?te("t_4_1745765868807"):null],trigger:()=>re(ue,{type:m.value?"primary":"default",class:Kn.footerButton,disabled:!w.value.provider,onClick:m.value?j:A},{default:()=>[m.value?te("t_27_1745735764546"):te("t_0_1745738961258")]})}),!m.value&&re(ue,{type:"primary",onClick:O},Xn(n=te("t_1_1745738963744"))?n:{default:()=>[n]})])])}}}),na=o({name:"DeployNode",props:{node:{type:Object,default:()=>({id:"",inputs:{},config:{}})}},setup(e,{expose:t}){const{renderNode:n}=Fn(e,Hn,((e,t)=>t.provider?re(ot,{icon:t.provider,type:e?"success":"warning"},null):te("t_9_1745735765287"))),{handleNodeClick:a}=Vn();return t({handleNodeClick:e=>{a(e,(e=>re(ta,{node:e},null)),!1,"68rem",!1)}}),n}}),aa=Object.freeze(Object.defineProperty({__proto__:null,default:na},Symbol.toStringTag,{value:"Module"})),oa={subject:{trigger:"input",required:!0,validator:(e,t)=>new Promise(((e,n)=>{t?t.length>100?n(new Error(te("t_3_1745887835089")+"长度不能超过100个字符")):e():n(new Error(te("t_3_1745887835089")))}))},body:{trigger:"input",required:!0,validator:(e,t)=>new Promise(((e,n)=>{t?t.length>1e3?n(new Error(te("t_4_1745887835265")+"长度不能超过1000个字符")):e():n(new Error(te("t_4_1745887835265")))}))},provider_id:{trigger:"change",type:"string",required:!0,validator:(e,t)=>new Promise(((e,n)=>{t?e():n(new Error(te("t_0_1745887835267")))}))}},ra=o({name:"NotifyNodeDrawer",props:{node:{type:Object,default:()=>({id:"",config:{provider:"",provider_id:"",subject:"",body:""}})}},setup(e){const{updateNodeConfig:t,isRefreshNode:n}=In(),{useFormInput:a,useFormTextarea:o,useFormCustom:r}=pe(),{confirm:l}=me(),{handleError:i}=qe(),s=J(fn(e.node.config)),d=[a(te("t_0_1745920566646"),"subject",{placeholder:te("t_3_1745887835089"),allowInput:at}),o(te("t_1_1745920567200"),"body",{placeholder:te("t_4_1745887835265"),rows:4,allowInput:at}),r((()=>re(st,{path:"provider_id",value:s.value.provider_id,isAddMode:!0,"onUpdate:value":e=>{s.value.provider_id=e.value,s.value.provider=e.type}},null)))],{component:u,data:c,example:p}=_e({defaultValue:s,config:d,rules:oa});return l((async a=>{var o;try{await(null==(o=p.value)?void 0:o.validate()),t(e.node.id,c.value),n.value=e.node.id,a()}catch(r){i(r)}})),()=>re("div",{class:"notify-node-drawer"},[re(u,{labelPlacement:"top"},null)])}}),la=o({name:"NotifyNode",props:{node:{type:Object,default:()=>({id:"",config:{}})}},setup(e,{expose:t}){const{renderNode:n}=Fn(e,oa,((e,t)=>t.provider?re(ot,{icon:t.provider,type:e?"success":"warning"},null):te("t_9_1745735765287"))),{handleNodeClick:a}=Vn();return t({handleNodeClick:e=>{a(e,(e=>re(ra,{node:e},null)))}}),n}}),ia=Object.freeze(Object.defineProperty({__proto__:null,default:la},Symbol.toStringTag,{value:"Module"})),sa={exec_type:{required:!0,message:te("t_31_1745735767891"),trigger:"change"},type:{required:!0,message:te("t_32_1745735767156"),trigger:"change"},week:{required:!0,message:te("t_33_1745735766532"),trigger:"input",type:"number"},month:{required:!0,message:te("t_33_1745735766532"),trigger:"input",type:"number"},hour:{required:!0,message:te("t_33_1745735766532"),trigger:"input",type:"number"},minute:{required:!0,message:te("t_33_1745735766532"),trigger:"input",type:"number"}};function da(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ce(e)}const ua=o({name:"StartNodeDrawer",props:{node:{type:Object,default:()=>({id:"",config:{exec_type:"auto"}})}},setup(e){const{updateNodeConfig:t,isRefreshNode:n}=In(),{confirm:a}=me(),{handleError:o}=qe(),{useFormRadio:r,useFormCustom:l}=pe(),i=J(fn(e.node.config)),s=[{label:te("t_2_1744875938555"),value:"day"},{label:te("t_0_1744942117992"),value:"week"},{label:te("t_3_1744875938310"),value:"month"}],u=[{label:te("t_1_1744942116527"),value:1},{label:te("t_2_1744942117890"),value:2},{label:te("t_3_1744942117885"),value:3},{label:te("t_4_1744942117738"),value:4},{label:te("t_5_1744942117167"),value:5},{label:te("t_6_1744942117815"),value:6},{label:te("t_7_1744942117862"),value:0}],c={day:{exec_type:"auto",type:"day",hour:1,minute:0},week:{exec_type:"auto",type:"week",hour:1,minute:0,week:1},month:{exec_type:"auto",type:"month",hour:1,minute:0,month:1}},p=(e,t,n,a)=>re(je,null,{default:()=>[re(he,{value:e,onUpdateValue:e=>{null!==e&&t(e)},max:n,min:0,showButton:!1,class:"w-full"},null),re(vt,null,da(a)?a:{default:()=>[a]})]}),v=d((()=>{const e=[];return"auto"===i.value.exec_type&&e.push(l((()=>{let e,t;return re(ie,{cols:24,xGap:24},{default:()=>[re(se,{label:te("t_2_1744879616413"),span:8,showRequireMark:!0,path:"type"},{default:()=>[re(de,{class:"w-full",options:s,value:i.value.type,"onUpdate:value":e=>i.value.type=e},null)]}),"day"!==i.value.type&&re(se,{span:5,path:"week"===i.value.type?"week":"month"},{default:()=>["week"===i.value.type?re(de,{value:i.value.week,onUpdateValue:e=>{"number"==typeof e&&(i.value.week=e)},options:u},null):p(i.value.month||0,(e=>i.value.month=e),31,te("t_29_1744958838904"))]}),re(se,{span:"day"===i.value.type?7:5,path:"hour"},da(e=p(i.value.hour||0,(e=>i.value.hour=e),23,te("t_5_1744879615277")))?e:{default:()=>[e]}),re(se,{span:"day"===i.value.type?7:5,path:"minute"},da(t=p(i.value.minute||0,(e=>i.value.minute=e),59,te("t_3_1744879615723")))?t:{default:()=>[t]})]})}))),[r(te("t_30_1745735764748"),"exec_type",[{label:te("t_4_1744875940750"),value:"auto"},{label:te("t_5_1744875940010"),value:"manual"}]),...e]})),{component:f,data:h,example:_}=_e({defaultValue:i,config:v,rules:sa}),m=e=>{let t={...e};if("manual"===t.exec_type){const e=Math.floor(6*Math.random())+1,n=5*Math.floor(12*Math.random());t={...t,hour:e,minute:n},i.value=t}};return ae((()=>i.value.exec_type),(e=>{"auto"===e?m(c.day):"manual"===e&&m({exec_type:"manual"})})),ae((()=>i.value.type),(e=>{e&&"auto"===i.value.exec_type&&m(c[e])})),a((async a=>{var r;try{await(null==(r=_.value)?void 0:r.validate()),t(e.node.id,h.value),n.value=e.node.id,a()}catch(l){o(l)}})),()=>re("div",{class:"apply-node-drawer"},[re(f,{labelPlacement:"top"},null)])}}),ca=o({name:"StartNode",props:{node:{type:Object,default:()=>({id:"",config:{}})}},setup(e,{expose:t}){const{renderNode:n}=Fn(e,sa,((e,t)=>e?"auto"===t.exec_type?te("t_4_1744875940750"):te("t_5_1744875940010"):"未配置")),{handleNodeClick:a}=Vn();return t({handleNodeClick:e=>{a(e,(e=>re(ua,{node:e},null)))}}),n}}),pa=Object.freeze(Object.defineProperty({__proto__:null,default:ca},Symbol.toStringTag,{value:"Module"})),va=En(te("t_12_1747817611391")),fa={key:va.required("key",te("t_38_1745735769521"),["input","blur","focus"]),cert:va.required("cert",te("t_40_1745735815317"),["input","blur","focus"])},ha=o({name:"UploadNodeDrawer",props:{node:{type:Object,default:()=>({id:"",config:{cert_id:"",cert:"",key:""}})}},setup(e){const{updateNodeConfig:t,isRefreshNode:n}=In(),{useFormTextarea:a,useFormSelect:o,useFormHelp:r}=pe(),l=J(fn(e.node.config)),{confirm:i,options:s}=me(),{handleError:u}=qe(),c=s(),p=J([{cert:"",key:"",label:"自定义证书",value:""}]),v=d((()=>""!==l.value.cert_id)),f=d((()=>({readonly:v.value,allowInput:at,rows:6}))),h=d((()=>[o(te("t_0_1747110184700"),"cert_id",p.value,{filterable:!0,onUpdateValue:e=>{l.value.cert_id=e;const t=g(e);t&&(l.value.cert=t.cert,l.value.key=t.key)}},{showRequireMark:!1}),a(te("t_34_1745735771147"),"cert",{placeholder:te("t_35_1745735781545"),...f.value}),a(te("t_36_1745735769443"),"key",{placeholder:te("t_37_1745735779980"),...f.value}),r([{content:te("t_1_1747110191587")},{content:te("t_2_1747110193465")}])])),{component:_,data:m,example:y}=_e({defaultValue:l,config:h,rules:fa}),g=e=>p.value.find((t=>t.value===e));return le((async()=>{await(async()=>{try{const{data:e}=await ut({p:1,limit:100}).fetch();p.value=(null==e?void 0:e.map((e=>({cert:e.cert,key:e.key,label:e.domains+" 【 "+e.issuer+" 】",value:e.sha256}))))||[],p.value.unshift({cert:"",key:"",label:"自定义证书",value:""})}catch(e){p.value=[],u(e)}})()})),c.value.confirmText=d((()=>""===l.value.cert_id?te("t_3_1747110185110"):te("t_2_1744861190040"))),i((async a=>{var o;try{if(await(null==(o=y.value)?void 0:o.validate()),""===l.value.cert_id){const{data:e}=await dt(l.value).fetch();l.value.cert_id=e}t(e.node.id,m.value),n.value=e.node.id,a()}catch(r){u(r)}})),()=>re("div",{class:"upload-node-drawer"},[re(_,{labelPlacement:"top"},null)])}}),_a=o({name:"UploadNode",props:{node:{type:Object,default:()=>({id:"",config:{}})}},setup(e,{expose:t}){const{renderNode:n}=Fn(e,fa,((e,t)=>te(e?"t_8_1745735765753":"t_9_1745735765287"))),{handleNodeClick:a}=Vn();return t({handleNodeClick:e=>{a(e,(e=>re(ha,{node:e},null)))}}),n}}),ma=Object.freeze(Object.defineProperty({__proto__:null,default:_a},Symbol.toStringTag,{value:"Module"})),ya=be(),{flowData:ga,selectedNodeId:ba,setflowZoom:wa,initFlowData:Na,updateFlowData:xa,setShowAddNodeSelect:ka,addNode:Ca,getAddNodeSelect:Sa,resetFlowData:ja}=In(),{workflowData:za,addNewWorkflow:$a,updateWorkflowData:Aa,resetWorkflowData:Oa}=ct(),{handleError:Ra}=qe();const Ia=o({name:"EndNode",setup:()=>()=>re("div",{class:"flex flex-col items-center justify-center"},[re("div",{class:"w-[1.5rem] h-[1.5rem] rounded-[1rem] bg-[#cacaca]"},null),re("div",{class:"text-[#5a5e66] mb-[10rem]"},[Ae("流程结束")])])}),Fa="_add_iwsp6_1",Ea="_addBtn_iwsp6_23",Da="_addBtnIcon_iwsp6_49",Ma="_addSelectBox_iwsp6_55",qa="_addSelectItem_iwsp6_78",Ba="_addSelectItemIcon_iwsp6_98",Pa="_addSelectItemTitle_iwsp6_104",Va="_addSelected_iwsp6_108",Ta="_addLeft_iwsp6_113",Ua="_addRight_iwsp6_122",La=o({name:"AddNode",props:{node:{type:Object,default:()=>({})}},setup(e){const{isShowAddNodeSelect:t,nodeSelectList:n,addNodeBtnRef:a,addNodeSelectRef:o,addNodeSelectPostion:r,showNodeSelect:l,addNodeData:i,itemNodeSelected:s,excludeNodeSelectList:d}=function(){const e=In(),t=J(!1),n=J(null);return Sa(),{...e,addNodeData:(e,n)=>{t.value=!1,e.id&&Ca(e.id,n,{id:gn()})},itemNodeSelected:()=>{clearTimeout(n.value)},isShowAddNodeSelect:t,showNodeSelect:(e,a)=>{e?(t.value=!1,t.value=e):(clearTimeout(n.value),n.value=window.setTimeout((()=>{t.value=e}),200)),a&&ka(e,a)}}}(),u=J();return ae((()=>e.node.type),(e=>{u.value=$n[e]()||{}})),()=>re("div",{class:Fa},[re("div",{ref:a,class:Ea,onMouseenter:()=>l(!0,e.node.type),onMouseleave:()=>l(!1)},[re(nt,{icon:"plus",class:Da,color:"#FFFFFF"},null),t.value&&re("ul",{ref:o,class:[Ma,1===r.value?Ta:Ua]},[n.value.map((t=>{var n;return(null==(n=d.value)?void 0:n.includes(t.type))?null:re("li",{key:t.type,class:[qa,t.selected&&Va],onClick:()=>i(e.node,t.type),onMouseenter:s},[re(nt,{icon:"flow-"+t.icon.name,class:Ba,color:t.selected?"#FFFFFF":t.icon.color},null),re("div",{class:Pa},[t.title.name])])}))])])])}}),Ha="_flowNodeBranch_yygcj_1",Za="_multipleColumns_yygcj_6",Wa="_flowNodeBranchBox_yygcj_10",Ja="_hasNestedBranch_yygcj_15",Ga="_flowNodeBranchCol_yygcj_19",Ya="_coverLine_yygcj_39",Ka="_topLeftCoverLine_yygcj_43",Xa="_topRightCoverLine_yygcj_47",Qa="_bottomLeftCoverLine_yygcj_51",eo="_bottomRightCoverLine_yygcj_55",to="_rightCoverLine_yygcj_59",no="_leftCoverLine_yygcj_63",ao="_flowConditionNodeAdd_yygcj_67",oo=o({name:"BranchNode",props:{node:{type:Object,default:()=>({})}},setup(e){const{addNode:t}=In(),n=J($n[e.node.type]()||{});ae((()=>e.node.type),(e=>{n.value=$n[e]()||{}}));const a=()=>{var n,a;const o=gn();t(e.node.id||"",Nn,{id:o,name:`分支${((null==(n=e.node.conditionNodes)?void 0:n.length)||0)+1}`},null==(a=e.node.conditionNodes)?void 0:a.length)},o=()=>{var t;const n=(null==(t=e.node.conditionNodes)?void 0:t.length)||0;return n>3?`${Ha} ${Za}`:Ha},r=()=>{var t;const n=null==(t=e.node.conditionNodes)?void 0:t.some((e=>e.childNode&&["branch","execute_result_branch"].includes(e.childNode.type)));return n?`${Wa} ${Ja}`:Wa};return()=>{var t,l,i;return re("div",{class:o()},[(null==(t=n.value.operateNode)?void 0:t.addBranch)&&re("div",{class:ao,onClick:a},[(null==(l=n.value.operateNode)?void 0:l.addBranchTitle)||"添加分支"]),re("div",{class:r()},[null==(i=e.node.conditionNodes)?void 0:i.map(((t,n)=>{var a,o;return re("div",{class:Ga,key:n,"data-branch-index":n,"data-branches-count":null==(a=e.node.conditionNodes)?void 0:a.length},[re($o,{node:t},null),0===n&&re("div",null,[re("div",{class:`${Ya} ${Ka}`},null),re("div",{class:`${Ya} ${Qa}`},null),re("div",{class:`${to}`},null)]),n===((null==(o=e.node.conditionNodes)?void 0:o.length)||0)-1&&re("div",null,[re("div",{class:`${Ya} ${Xa}`},null),re("div",{class:`${Ya} ${eo}`},null),re("div",{class:`${no}`},null)])])}))]),re(La,{node:e.node},null)])}}}),ro=o({name:"BranchNode",props:{node:{type:Object,default:()=>({})}},setup(e){const{addNode:t}=In(),n=J($n[e.node.type]()||{});ae((()=>e.node.type),(e=>{n.value=$n[e]()||{}}));const a=()=>{var n,a;const o=gn();t(e.node.id||"",Nn,{id:o,name:`分支${((null==(n=e.node.conditionNodes)?void 0:n.length)||0)+1}`},null==(a=e.node.conditionNodes)?void 0:a.length)},o=()=>{var t;const n=(null==(t=e.node.conditionNodes)?void 0:t.length)||0;return n>3?`${Ha} ${Za}`:Ha},r=()=>{var t;const n=null==(t=e.node.conditionNodes)?void 0:t.some((e=>e.childNode&&["branch","execute_result_branch"].includes(e.childNode.type)));return n?`${Wa} ${Ja}`:Wa};return()=>{var t,l,i;return re("div",{class:o()},[(null==(t=n.value.operateNode)?void 0:t.addBranch)&&re("div",{class:ao,onClick:a},[(null==(l=n.value.operateNode)?void 0:l.addBranchTitle)||"添加分支"]),re("div",{class:r()},[null==(i=e.node.conditionNodes)?void 0:i.map(((t,n)=>{var a,o;return re("div",{class:Ga,key:n,"data-branch-index":n,"data-branches-count":null==(a=e.node.conditionNodes)?void 0:a.length},[re($o,{node:t},null),0===n&&re("div",null,[re("div",{class:`${Ya} ${Ka}`},null),re("div",{class:`${Ya} ${Qa}`},null),re("div",{class:`${to}`},null)]),n===((null==(o=e.node.conditionNodes)?void 0:o.length)||0)-1&&re("div",null,[re("div",{class:`${Ya} ${Xa}`},null),re("div",{class:`${Ya} ${eo}`},null),re("div",{class:`${no}`},null)])])}))]),re(La,{node:e.node},null)])}}}),lo="_node_fkn6k_1",io="_nodeArrows_fkn6k_5",so="_nodeContent_fkn6k_19",uo="_nodeHeader_fkn6k_44",co="_nodeHeaderBranch_fkn6k_48",po="_nodeCondition_fkn6k_52",vo="_nodeConditionHeader_fkn6k_56",fo="_nodeIcon_fkn6k_72",ho="_nodeHeaderTitle_fkn6k_80",_o="_nodeHeaderTitleInput_fkn6k_88",mo="_nodeClose_fkn6k_108",yo="_nodeBody_fkn6k_112",go="_nodeErrorMsg_fkn6k_129",bo="_nodeErrorMsgBox_fkn6k_133",wo="_nodeErrorIcon_fkn6k_137",No="_nodeErrorTips_fkn6k_141",xo=o({name:"BranchNode",props:{node:{type:Object,default:()=>({})}},setup:()=>()=>re("div",null,[Ae("渲染节点失败，请检查类型是否支持")])}),ko=Object.freeze(Object.defineProperty({__proto__:null,default:xo},Symbol.toStringTag,{value:"Module"})),Co=o({name:"BaseNode",props:{node:{type:Object,required:!0}},setup(e){const t=z("taskComponents",{}),{validator:n,validate:a}=cn(),o=J(e.node.id||gn()),l=J($n[e.node.type]()||{}),i=J(null),s=J(!1),u=J(e.node.name),c=J(),p=J(),{removeNode:v,updateNode:f,selectedNodeId:h,selectedNode:_}=In(),m=J({isError:!1,message:null,showTips:!1}),y=d((()=>e.node.type===bn)),g=d((()=>{var e,t;return null==(t=null==(e=l.value)?void 0:e.operateNode)?void 0:t.remove})),b=d((()=>[Nn,kn].includes(e.node.type))),w=d((()=>{var t;return e.node.type===kn&&{success:"flow-success",fail:"flow-error"}[null==(t=e.node.config)?void 0:t.type]||""})),N=d((()=>{var t;return e.node.type===kn?(null==(t=e.node.config)?void 0:t.type)||"":"#FFFFFF"}));ae((()=>e.node),(()=>{l.value=$n[e.node.type](),u.value=e.node.name,o.value=e.node.id||gn(),n.validateAll();const a=`${e.node.type}Node`;t&&t[a]?c.value=Oe(t[a]):c.value=Oe(Re({loader:()=>Ie((()=>Promise.resolve().then((()=>ko))),void 0,import.meta.url),loadingComponent:()=>re("div",null,[Ae("Loading...")]),errorComponent:()=>re(xo,null,null)}))}),{immediate:!0});const x=e=>{m.value.showTips=e},k=()=>{var t;(null==(t=p.value)?void 0:t.handleNodeClick)&&e.node.type!==Nn&&e.node.type!==kn&&(h.value=e.node.id||"",p.value.handleNodeClick(_))},C=e=>{13===e.keyCode&&(s.value=!1)},S=e=>{const t=e.target;u.value=t.value,f(o.value,{name:u.value})};return()=>{var t,n,d,f,h,_;return re("div",{class:[lo,!y.value&&io]},[re("div",{class:[so,b.value&&po],onClick:k},[re("div",{class:[uo,b.value&&vo,w.value?"":co],style:{color:null==(n=null==(t=l.value)?void 0:t.title)?void 0:n.color,backgroundColor:null==(f=null==(d=l.value)?void 0:d.title)?void 0:f.bgColor}},[w.value?re(nt,{icon:w.value?w.value:(null==(_=null==(h=l.value)?void 0:h.icon)?void 0:_.name)||"",class:[fo,"!absolute top-[50%] left-[1rem] -mt-[.8rem]"],color:N.value},null):null,re("div",{class:ho,title:"点击编辑"},[re("div",{class:_o},[re("input",{ref:i,value:u.value,onClick:e=>e.stopPropagation(),onInput:S,onBlur:()=>s.value=!1,onKeyup:C},null)])]),g.value&&re("span",{onClick:t=>((e,t,n)=>{const o=a(t);o.valid&&Pe({type:"warning",title:te("t_1_1745765875247",{name:n.name}),content:n.type===Nn?te("t_2_1745765875918"):te("t_3_1745765920953"),onPositiveClick:()=>v(t)}),![kn].includes(n.type)&&o.valid||v(t),e.stopPropagation(),e.preventDefault()})(t,o.value,e.node),class:"flex items-center justify-center absolute top-[50%] right-[1rem] -mt-[.9rem]"},[re(nt,{class:mo,icon:"close",color:b.value?"#333":"#FFFFFF"},null)])]),b.value?null:re("div",{class:[yo]},[c.value&&r(c.value,{id:e.node.id,node:e.node||{},class:"text-center",ref:p})]),m.value.showTips&&re("div",{class:go},[re("div",{class:bo},[re("span",{onMouseenter:()=>x(!0),onMouseleave:()=>x(!1)},[re(nt,{class:wo,icon:"tips",color:"red"},null)]),m.value.message&&re("div",{class:No},[m.value.message])])])]),re(La,{node:e.node},null)])}}}),So="flex flex-col items-center w-full relative",jo="nested-node-wrap w-full",zo="deep-nested-node-wrap w-full",$o=o({name:"NodeWrap",props:{node:{type:Object,default:()=>({})},depth:{type:Number,default:0}},setup:e=>({getDepthClass:()=>e.depth&&e.depth>1?e.depth>2?zo:jo:So}),render(){var e;if(!this.node)return null;const t=(this.depth||0)+1;return re("div",{class:this.getDepthClass()},[this.node.type===wn?re(oo,{node:this.node},null):null,this.node.type===xn?re(ro,{node:this.node},null):null,[wn,xn].includes(this.node.type)?null:re(Co,{node:this.node},null),(null==(e=this.node.childNode)?void 0:e.type)&&re($o,{node:this.node.childNode,depth:t},null)])}}),Ao={flowContainer:"_flowContainer_4rj8i_1",flowProcess:"_flowProcess_4rj8i_5",flowZoom:"_flowZoom_4rj8i_9",flowZoomIcon:"_flowZoomIcon_4rj8i_13"},Oo=o({name:"FlowChart",props:{isEdit:{type:Boolean,default:!1},type:{type:String,default:"quick"},node:{type:Object,default:()=>({})},taskComponents:{type:Object,default:()=>({})}},setup(e,{slots:t}){const n=ne(["borderColor","dividerColor","textColor1","textColor2","primaryColor","primaryColorHover","bodyColor"]),{flowData:a,selectedNodeId:o,flowZoom:r,resetFlowData:l}=In(),{initData:i,handleSaveConfig:s,handleZoom:d,goBack:u}=((e={type:"quick",node:ga.value,isEdit:!1})=>{const t=ze(),n=$e();return e.node&&ae((()=>e.node),(e=>{xa(e)}),{deep:!0}),{flowData:ga,selectedNodeId:ba,handleSaveConfig:()=>{const{validator:e}=cn(),a=e.validateAll();try{if(a.valid&&ga.value.name){const{active:e}=za.value,{id:a,name:o,childNode:r}=ga.value,{exec_type:l,...i}=r.config,s={name:o,active:e,content:JSON.stringify(r),exec_type:l,exec_time:JSON.stringify(i||{})};n.query.isEdit?Aa({id:a,...s}):$a(s),t.push("/auto-deploy")}else ga.value.name||ya.error("保存失败，请输入工作流名称");for(const e in a.results)if(a.results.hasOwnProperty(e)){const t=a.results[e];if(!t.valid){ya.error(t.message);break}}}catch(o){Ra(o).default(te("t_12_1745457489076"))}},handleZoom:e=>{wa(e)},handleRun:()=>{ya.info(te("t_8_1744861189821"))},goBack:()=>{t.back()},initData:()=>{ja(),Oa(),e.isEdit&&e.node?xa(e.node):"quick"===e.type?Na():"advanced"===e.type&&xa(e.node)}}})({type:null==e?void 0:e.type,node:null==e?void 0:e.node,isEdit:null==e?void 0:e.isEdit});return w("taskComponents",e.taskComponents),le(i),oe(l),()=>{var e;return re("div",{class:"flex flex-col w-full h-full",style:n.value},[re("div",{class:"w-full h-[6rem] px-[2rem] mb-[2rem] rounded-lg flex items-center gap-2 justify-between"},[re("div",{class:"flex items-center"},[re(ue,{onClick:u},{default:()=>[re(Fe,{class:"mr-1"},{default:()=>[re(wt,null,null)]}),te("t_0_1744861190562")]})]),re("div",{class:"flex items-center ml-[.5rem]"},[re(xe,{value:a.value.name,"onUpdate:value":e=>a.value.name=e,placeholder:te("t_0_1745490735213"),class:"!w-[30rem] !border-none "},null)]),re("div",{class:"flex items-center gap-2"},[re(ue,{type:"primary",onClick:s,disabled:!o},{default:()=>[re(Fe,{class:"mr-1"},{default:()=>[re(xt,null,null)]}),te("t_2_1744861190040")]})])]),re("div",{class:"w-full flex"},[re("div",{class:Ao.flowContainer},[re("div",{class:Ao.flowProcess,style:{transform:`scale(${r.value/100})`}},[re($o,{node:a.value.childNode},null),re(Ia,null,null)]),re("div",{class:Ao.flowZoom},[re("div",{class:Ao.flowZoomIcon,onClick:()=>d(1)},[re(nt,{icon:"subtract",class:`${50===r.value?Ao.disabled:""}`,color:"#5a5e66"},null)]),re("span",null,[r.value,Ae("%")]),re("div",{class:Ao.flowZoomIcon,onClick:()=>d(2)},[re(nt,{icon:"plus",class:`${300===r.value?Ao.disabled:""}`,color:"#5a5e66"},null)])])])]),null==(e=t.default)?void 0:e.call(t)])}}}),Ro=o({name:"WorkflowView",setup(){const{init:e}=(()=>{const{workflowType:e,detectionRefresh:t}=ct(),n=$e(),a=ze(),o=e=>(e.preventDefault(),e.returnValue=te("t_16_1747886308182"),te("t_16_1747886308182"));return oe((()=>{window.removeEventListener("beforeunload",o)})),{init:()=>{window.addEventListener("beforeunload",o);const r=n.query.type;r&&(e.value=r),t.value||"/auto-deploy"===n.path||a.push("/auto-deploy")}}})(),{workflowType:t,workDefalutNodeData:n,isEdit:a}=ct(),o=Object.assign({"./node/apply/index.tsx":Un,"./node/deploy/index.tsx":aa,"./node/notify/index.tsx":ia,"./node/start/index.tsx":pa,"./node/upload/index.tsx":ma}),r=J({});return Ee((()=>{const e={};Object.entries(o).forEach((([t,n])=>{const a=t.match(/\/node\/([^/]+)\/index\.tsx$/);if(a&&a[1]){const t=a[1];e[`${t}Node`]=n.default||n}})),r.value=e})),le(e),()=>re(Oo,{type:t.value,node:n.value,isEdit:a.value,taskComponents:r.value},null)}});export{Ro as default};
